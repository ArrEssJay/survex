# @configure_input@
Summary: Cave Surveying Software
Name: @PACKAGE@
Vendor: The Survex Project
Version: @VERSION@
Release: @RELEASE@
License: GPL
Group: Applications/Misc
Source: http://www.survex.com/software/@VERSION@/@PACKAGE@-@VERSION@.tar.gz
URL: http://www.survex.com/
Packager: Olly Betts <olly@survex.com>
#Can't build with rpm on debian with this next line uncommented:
#BuildRequires: wxGTK-devel >= 2.4.0
BuildRoot: %{_tmppath}/%{name}-buildroot

%description
@DESC@

%package aven
Summary: Aven viewer for Survex
Group: Applications/Misc
Requires: survex = @VERSION@, wxGTK >= 2.4.0

%description aven
@AVENDESC@

%package svxedit
Summary: SvxEdit survey data editor for Survex
Group: Applications/Misc
Requires: survex = @VERSION@

%description svxedit
@SVXEDITDESC@

%prep
%setup

%build
[ "%{buildroot}" = "/" ] && echo "buildroot cannot be /" && exit 1
./configure --prefix=/usr
make

%install
[ "%{buildroot}" = "/" ] && echo "buildroot cannot be /" && exit 1
[ "%{buildroot}" != "/" ] && rm -rf %{buildroot}
mkdir -p "%{buildroot}"
make install-strip DESTDIR="%{buildroot}"
# Rearrange to conform to the FHS.
mv "%{buildroot}"/usr/man "%{buildroot}"/usr/share/man
# Move docs back into build tree to keep rpmbuild happy by letting
# it do the installing.
mv "%{buildroot}"/usr/share/doc/@PACKAGE@ ./built-docs

%clean
[ "%{buildroot}" = "/" ] && echo "buildroot cannot be /" && exit 1
[ "%{buildroot}" != "/" ] && rm -rf %{buildroot}

%files
%defattr(-, root, root)
%doc @EXTRA_TEXT@
%doc built-docs/*
%doc /usr/share/man/
%exclude /usr/share/man/man1/aven*
%exclude /usr/share/man/man1/svxedit*
/usr/bin/*
%exclude /usr/bin/aven
%exclude /usr/bin/svxedit
/usr/share/@PACKAGE@/
%exclude /usr/share/@PACKAGE@/icons/????*.png
/usr/share/mime-info/survex.*
%files aven
%defattr(-, root, root)
%doc /usr/share/man/man1/aven*
/usr/bin/aven
/usr/share/@PACKAGE@/icons/????*.png
%files svxedit
%defattr(-, root, root)
%doc /usr/share/man/man1/svxedit*
/usr/bin/svxedit
