#! /bin/sh
if cvs diff > /dev/null 2> /dev/null ; then
   :
   # Everything is in CVS
else
   echo There are changes not checked into CVS - please rectify
   exit 1
fi
# Update ChangeLog
../cvs2cl/cvs2cl.pl || exit 1
test -f Makefile && make distclean || exit 1
make distcheck || exit 1
make dos_doc_zip || exit 1
#env STRIP=echo EXTEXE=.exe CC=dos-gcc LDFLAGS=-s CAVEROT=caverot.exe \
# CRLIB=-lalleg CROBJX=dosrot.o ./configure --with-x=no
#PATH=/usr/local/cross-tools/bin:/usr/local/cross-tools/i386-mingw32msvc/bin:$PATH
env CC=i386-pc-msdosdjgpp-gcc LDFLAGS=-s STRIP=echo CAVEROT=caverot.exe \
 CRLIB=-lalleg CROBJX=dosrot.o ./configure --with-x=no || exit 1
make djgpp || exit 1
make distclean || exit 1
rm config.cache || exit 1
PATH=/usr/local/cross-tools/bin:/usr/local/cross-tools/i386-mingw32msvc/bin:$PATH
env ac_cv_c_bigendian=no LDFLAGS=-s ./configure --with-x=no || exit 1
make mingw || exit 1
