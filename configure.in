dnl Process this file with autoconf to produce a configure script.
AC_INIT(survex.c)

AC_C_BIGENDIAN

dnl Checks for programs.
AC_PROG_CC

AC_CHECK_PROGS(STRIP, strip, echo "not stripping ")

EXE_SUFFIX=${EXE_SUFFIX=}
AC_SUBST(EXE_SUFFIX)

dnl Checks for libraries.
dnl Replace `main' with a function in -lX11:
dnl AC_CHECK_LIB(X11, main)
dnl Replace `main' with a function in -lallegro:
dnl AC_CHECK_LIB(allegro, main)
dnl Replace `main' with a function in -lgrx20:
dnl AC_CHECK_LIB(grx20, main)
dnl Replace `main' with a function in -lj:
dnl AC_CHECK_LIB(j, main)
dnl Replace `main' with a function in -lpc:
dnl AC_CHECK_LIB(pc, main)

AC_CHECK_LIB(m, sqrt)

dnl Checks for header files.
AC_PATH_XTRA

if test x$no_x != xyes; then
  CAVEROT=xcaverot ${CAVEROT}
  AC_MSG_RESULT("building xcaverot")
fi
AC_SUBST(CAVEROT)

dnl caverot libraries...
AC_SUBST(CRLIB)
dnl caverot platform specific objects...
AC_SUBST(CROBJX)

AC_HEADER_STDC
AC_CHECK_HEADERS(limits.h)

dnl Checks for typedefs, structures, and compiler characteristics.
AC_C_CONST
AC_TYPE_SIZE_T
AC_STRUCT_TM
AC_TYPE_SIGNAL

dnl Checks for library functions.
AC_TYPE_SIGNAL
AC_FUNC_STRFTIME
AC_FUNC_VPRINTF
AC_CHECK_FUNCS(mktime strdup strerror perror strtod strtol popen setjmp signal)

dnl difftime seems to be an ANSI invention
AC_CHECK_FUNC(difftime, , AC_DEFINE(difftime(A,B), ((B)-(A)) ) )

dnl try to find a case-insensitive compare

AC_MSG_CHECKING(how to compare strings ignoring case)
AC_MSG_RESULT()
strcasecmp=no
# The order of these tests is important.
AC_CHECK_FUNC(strcasecmp, strcasecmp=strcasecmp )
if test $strcasecmp = no; then
  AC_CHECK_FUNC(stricmp, AC_DEFINE(strcasecmp, stricmp) strcasecmp=stricmp )
fi
if test $strcasecmp = no; then
  AC_CHECK_FUNC(strcmpi, AC_DEFINE(strcasecmp, strcmpi) strcasecmp=strcmpi )
fi
if test $strcasecmp = no; then
  LIBOBJS="$LIBOBJS strcasecmp.o"
  AC_MSG_RESULT("using own implementation of strcasecmp")
fi

AC_OUTPUT(Makefile)
