Mon Jan 27 20:25:39 GMT 2014  Olly Betts <olly@survex.com>

	* src/gfxcore.cc: Don't default to percent gradient.

Mon Jan 27 11:44:49 GMT 2014  Olly Betts <olly@survex.com>

	* NEWS,configure.ac: Update for 1.2.11.

Mon Jan 27 11:16:27 GMT 2014  Olly Betts <olly@survex.com>

	* make_release: Run "make check" under valgrind.

Mon Jan 27 11:15:17 GMT 2014  Olly Betts <olly@survex.com>

	* src/cad3d.c,src/str.c,src/str.h: Rename s_cat_len() to s_catlen()
	  for consistency with s_catchar().

Mon Jan 27 11:13:31 GMT 2014  Olly Betts <olly@survex.com>

	* make_release: Add simple check for // comments in C sources.
	* make_release: Before release, build with -Werror to catch any
	  warnings which may have been missed.

Mon Jan 27 10:25:02 GMT 2014  Olly Betts <olly@survex.com>

	* src/: Make cad3d remap control characters and spaces in station
	  names when generating PLT output in the same way aven does.

Mon Jan 27 07:43:27 GMT 2014  Olly Betts <olly@survex.com>

	* NEWS: Update.

Mon Jan 27 06:01:15 GMT 2014  Olly Betts <olly@survex.com>

	* lib/,src/: Add support for showing percentage gradient in the tilt
	  indicator in aven.  Show the units (degrees, grads, or percent) for
	  the tilt and bearing indicators.

Mon Jan 27 05:40:04 GMT 2014  Olly Betts <olly@survex.com>

	* src/mainfrm.cc: Fix GCC warnings.

Mon Jan 27 05:37:02 GMT 2014  Olly Betts <olly@survex.com>

	* src/glbitmapfont.cc,src/glbitmapfont.h:
	  BitmapFont::get_text_extent() now uses the width of all glyphs,
	  rather than assuming all those > BITMAPFONT_MAX_CHAR have width 16.

Mon Jan 27 05:32:12 GMT 2014  Olly Betts <olly@survex.com>

	* src/glbitmapfont.cc: Fix writing of Unicode characters above
	  BITMAPFONT_MAX_CHAR (which is 256 currently).

Mon Jan 27 00:44:30 GMT 2014  Olly Betts <olly@survex.com>

	* src/gfxcore.cc: Try to work around measuring line redraw issues on
	  Microsoft Windows by redrawing the whole window, which doesn't
	  seem to be measurably slower.

Mon Jan 27 00:21:30 GMT 2014  Olly Betts <olly@survex.com>

	* lib/: Translation updates.

Sun Jan 26 23:50:31 GMT 2014  Olly Betts <olly@survex.com>

	* doc/manual.sgml: Add missing quantities to the list documented as
	  accepted by *units: LEFT, RIGHT, UP/CEILING, DOWN/FLOOR (missing
	  entirely); BACKCOMPASS/BACKBEARING, BACKCLINO/BACKGRADIENT (missing
	  from the main list, mentioned in list of the units that can be set
	  for them); COUNT (missing alternative name for COUNTER); DX/EASTING,
	  DY/NORTHING, DZ/ALTITUDE (incorrectly listed as X, Y, Z).  Reported
	  by Jonny Prouty.

Sun Jan 26 23:48:19 GMT 2014  Olly Betts <olly@survex.com>

	* src/commands.c: If *units is used to set units for LEVEL, PLUMB, or
	  POSITION, give an error rather than quietly ignore the attempt.
	* tests/: New regression testcase bad_units_qlist.

Sun Jan 26 23:35:18 GMT 2014  Olly Betts <olly@survex.com>

	* tests/bad_units_factor.svx,tests/cavern.tst: Test that "*units
	  backclino 0 percent" gives an error about the factor being zero.
	* tests/Makefile.am,tests/bad_units_factor.out: Add expected output
	  to make sure we're getting the errors we expect, not just the
	  expected number of errors.

Fri Jan 24 06:20:49 GMT 2014  Olly Betts <olly@survex.com>

	* lib/de.po,lib/de_CH.po: Update.

Fri Jan 24 05:08:19 GMT 2014  Olly Betts <olly@survex.com>

	* src/gfxcore.cc: Don't crash with assertion failure when showing
	  passages for a cave with no vertical extent.  Reported by Jonny
	  Prouty.

Fri Jan 24 05:07:34 GMT 2014  Olly Betts <olly@survex.com>

	* src/moviemaker.cc: Fix to build again with libav/ffmpeg.

Tue Jan 23 19:52:21 GMT 2014  Olly Betts <olly@survex.com>

	* src/gfxcore.cc: Simplify accounting for size of blobs on measuring
	  line.

Thu Jan 23 11:42:01 GMT 2014  Olly Betts <olly@survex.com>

	* src/moviemaker.cc,src/moviemaker.h: Fix to actually build without
	  libav/ffmpeg.

Thu Jan 23 11:34:30 GMT 2014  Olly Betts <olly@survex.com>

	* lib/,src/: Make all uses of unit names translatable.

Tue Jan 21 12:23:06 GMT 2014  Olly Betts <olly@survex.com>

	* lib/fr.po: Merge translation updates from Eric Madelaine.

Tue Jan 21 11:31:22 GMT 2014  Olly Betts <olly@survex.com>

	* lib/: More translation updates.

Tue Jan 21 10:32:08 GMT 2014  Olly Betts <olly@survex.com>

	* lib/Makefile.am,lib/generate-po-todo: Add script and makefile target
	  to pick out the messages from each po file which need attention.

Tue Jan 21 10:30:45 GMT 2014  Olly Betts <olly@survex.com>

	* lib/survex.pot,src/mainfrm.cc: Allow "m" and "ft" suffixes to be
	  translated.

Tue Jan 21 04:14:55 GMT 2014  Olly Betts <olly@survex.com>

	* doc/TODO.htm: Remove things which have now been done, and reorganise
	  the rest.

Tue Jan 21 03:48:07 GMT 2014  Olly Betts <olly@survex.com>

	* src/message.c: On Microsoft Windows 2000 and newer, use
	  GetUserDefaultUILanguage() to get the UI language to use.  For older
	  versions, continue to use GetUserDefaultLCID().

Tue Jan 21 02:29:06 GMT 2014  Olly Betts <olly@survex.com>

	* lib/,src/avenprcore.cc,src/printwx.cc: Change term "info box" to
	  "legend".

Tue Jan 21 02:15:38 GMT 2014  Olly Betts <olly@survex.com>

	* src/mainfrm.cc,src/mainfrm.h: If full screen, don't recreate the
	  side panel when a new file is opened (e.g. via Ctrl+O).

Mon Jan 20 05:33:04 GMT 2014  Olly Betts <olly@survex.com>

	* NEWS: Update.

Mon Jan 20 04:54:28 GMT 2014  Olly Betts <olly@survex.com>

	* lib/bg.po,lib/de.po,lib/de_CH.po: More translation updates.

Sun Jan 19 01:44:44 GMT 2014  Olly Betts <olly@survex.com>

	* lib/,src/netskel.c,tests/: Drop "between nodes" from the progress
	  messages while solving the survey network, as the extra words don't
	  make the meaning clearer, and "node" doesn't mean exactly the same
	  here as the summary of nodes printed at the end of processing, which
	  is a bit confusing.

Sun Jan 19 01:31:54 GMT 2014  Olly Betts <olly@survex.com>

	* lib/: More translation updates.

Sun Jan 19 00:51:33 GMT 2014  Olly Betts <olly@survex.com>

	* lib/po-to-msg.pl: Fix menu shortcut check to allow for non-ASCII
	  shortcuts.  Remove code to check for menu shortcuts marked with '@'
	  as we no longer do that.

Sat Jan 18 23:24:47 GMT 2014  Olly Betts <olly@survex.com>

	* buildmacosx.sh: Update to use wx 3.0.0, and add a checksum check for
	  the downloaded wx sources.  Thanks to David A. Riggs for his work on
	  getting the Mac OS X build going with wx 3.0.0.

Sat Jan 18 23:09:12 GMT 2014  Olly Betts <olly@survex.com>

	* src/gla-gl.cc: Split log_fl_error helper function out of
	  CHECK_GL_ERROR, which will reduce code size and also the number of
	  deprecation warnings about gluErrorString on Mac OS X 10.9.

Sat Jan 18 22:49:02 GMT 2014  Olly Betts <olly@survex.com>

	* lib/en_US.po: Translate "elevation" to "profile" in a couple of
	  places where we weren't.

Sat Jan 18 22:48:01 GMT 2014  Olly Betts <olly@survex.com>

	* src/message.c: Hook up Indonesian translation to be used when
	  Windows is set to Indonesian.

Sat Jan 18 22:47:20 GMT 2014  Olly Betts <olly@survex.com>

	* lib/checkshortcut.pl: Fix shortcut checking to allow for non-ASCII
	  shortcuts.

Sat Jan 18 22:45:50 GMT 2014  Olly Betts <olly@survex.com>

	* lib/Makefile.am,lib/bg.po,src/message.c: Add start of bulgarian
	  translation, with messages take from therion.

Fri Jan 17 07:39:48 GMT 2014  Olly Betts <olly@survex.com>

	* src/printwx.cc: Include wx headers before ISO C/C++ ones, to try to
	  fix build failure on OS X 10.9 with wx 3.0.0.

Fri Jan 17 07:27:34 GMT 2014  Olly Betts <olly@survex.com>

	* src/moviemaker.h: If we don't have libav or ffmpeg, omit all the
	  member variables from class MovieMaker, to avoid "unused private
	  field" warnings from clang.

Fri Jan 17 07:22:32 GMT 2014  Olly Betts <olly@survex.com>

	* src/: Use cast to void rather than assignment to self to suppress
	  unused parameter warnings, as clang warns about the latter.

Fri Jan 17 07:12:47 GMT 2014  Olly Betts <olly@survex.com>

	* src/aboutdlg.cc: Use string::erase() rather than assigning the
	  result of string::substr().

Thu Jan 16 03:58:18 GMT 2014  Olly Betts <olly@survex.com>

	* lib/: Update pot and po files with current linenumber references.

Thu Jan 16 03:57:55 GMT 2014  Olly Betts <olly@survex.com>

	* src/printwx.cc: Fix incorrect message in comment.

Thu Jan 16 03:46:23 GMT 2014  Olly Betts <olly@survex.com>

	* lib/extract-msgs.pl: Fix to handle there being a comment before the
	  comment with the message in.

Thu Jan 16 03:17:24 GMT 2014  Olly Betts <olly@survex.com>

	* lib/: Various translation updates.

Thu Jan 16 03:15:10 GMT 2014  Olly Betts <olly@survex.com>

	* lib/de.po,lib/de_CH.po: Move menu accelerator on "Farbschlüssel"
	  from "ü" to "F", since the latter isn't used in that menu.

Wed Jan 15 21:00:14 GMT 2014  Olly Betts <olly@survex.com>

	* lib/: Fill in some missing translations from existing similar
	  translations.

Wed Jan 15 10:55:44 GMT 2014  Olly Betts <olly@survex.com>

	* src/mainfrm.cc,src/mainfrm.h: Fix wxWidgets assertion when double
	  clicking on an anonymous station.  Reported by Kevin Dixon.

Wed Jan 15 07:11:30 GMT 2014  Olly Betts <olly@survex.com>

	* NEWS,configure.ac: Update for 1.2.10.

Wed Jan 15 07:07:25 GMT 2014  Olly Betts <olly@survex.com>

	* lib/ca.po,lib/de.po: Mark altered message as fuzzy in languages I
	  failed to before.

Wed Jan 15 06:25:10 GMT 2014  Olly Betts <olly@survex.com>

	* NEWS: Update.

Wed Jan 15 06:13:44 GMT 2014  Olly Betts <olly@survex.com>

	* src/img.c: Simplify reading of labels in 3d v1 and v2 files.

Wed Jan 15 06:11:12 GMT 2014  Olly Betts <olly@survex.com>

	* lib/,src/cavernlog.cc: If we fail to start the external editor,
	  throw up an error box.

Wed Jan 15 05:58:31 GMT 2014  Olly Betts <olly@survex.com>

	* src/img.c: Pass pimg->buf_len rather than literal 257.

Wed Jan 15 00:23:34 GMT 2014  Olly Betts <olly@survex.com>

	* src/img.c: Remove pointless "future expansion" comment from
	  img_read_item_ancient().

Wed Jan 15 00:22:22 GMT 2014  Olly Betts <olly@survex.com>

	* src/img.c: Tweak recursive calls in img_read_item_ancient() and
	  img_write_item_ancient() to directly call the same function.

Wed Jan 15 00:15:30 GMT 2014  Olly Betts <olly@survex.com>

	* src/img.c,src/useful.h: Fix some glibc fortify source warnings.

Wed Jan 15 00:13:27 GMT 2014  Olly Betts <olly@survex.com>

	* src/img.c: Make 4 internal functions static.

Tue Jan 14 21:57:03 GMT 2014  Olly Betts <olly@survex.com>

	* src/printwx.cc: Minor code refactor.

Tue Jan 14 21:51:58 GMT 2014  Olly Betts <olly@survex.com>

	* NEWS: Update.

Tue Jan 14 21:39:34 GMT 2014  Olly Betts <olly@survex.com>

	* lib/en_US.po: Add missing translation.

Tue Jan 14 21:25:01 GMT 2014  Olly Betts <olly@survex.com>

	* src/printwx.cc: Fix crash on "File->Print" or "File->Export" under
	  Windows XP, reported by Brian Clipstone.

Tue Jan 14 21:23:10 GMT 2014  Olly Betts <olly@survex.com>

	* src/aven.cc: Simplify handling of command line under __WXMSW__,
	  fixing error if run with no parameters.

Tue Jan 14 21:17:38 GMT 2014  Olly Betts <olly@survex.com>

	* configure.ac,src/img.c: Only use _putenv_s() under MSVC - mingw
	  doesn't provide it.

Tue Jan 14 21:14:51 GMT 2014  Olly Betts <olly@survex.com>

	* make_release: Turn on optimisation when building aven for Microsoft
	  Windows.

Tue Jan 14 04:17:10 GMT 2014  Olly Betts <olly@survex.com>

	* src/guicontrol.cc: If dragging with more than one mouse button held
	  down, releasing one causes another which is still held down to take
	  effect.

Tue Jan 14 03:33:38 GMT 2014  Olly Betts <olly@survex.com>

	* src/guicontrol.cc: Fix assertion if two mouse buttons are held down
	  at the same time.  Reported by Brian Clipstone.

Tue Jan 14 03:22:54 GMT 2014  Olly Betts <olly@survex.com>

	* src/img.c,src/mainfrm.cc: Although these are often referred to as
	  "CMAP .XYZ files", it seems that actually, the extension .XYZ isn't
	  used, rather .SHT (shot variant, produced by CMAP v16 and later),
	  .UNA (unadjusted) and .ADJ (adjusted) extensions are.  Since we've
	  long checked for .XYZ, we continue to do so in case anyone is
	  relying on it, but also check for the other extensions.

Tue Jan 14 03:20:03 GMT 2014  Olly Betts <olly@survex.com>

	* buildmacosx.sh,configure.ac,doc/manual.sgml: Update references to
	  Survex 1.1 which should be to 1.2.

Tue Jan 14 03:14:31 GMT 2014  Olly Betts <olly@survex.com>

	* doc/manual.sgml: Note the station length limit Smaps used.

Tue Jan 14 02:55:02 GMT 2014  Olly Betts <olly@survex.com>

	* tests/expobug.svx: Fix comment typo.

Tue Jan 14 02:52:52 GMT 2014  Olly Betts <olly@survex.com>

	* src/imgtest.c: Fix printf format to actually match types of
	  parameters.

Tue Jan 14 02:52:31 GMT 2014  Olly Betts <olly@survex.com>

	* src/gpx.cc: Fix comment typo.

Tue Jan 14 02:48:59 GMT 2014  Olly Betts <olly@survex.com>

	* src/: Pass the numeric datestamp to ExportFilter::header(), and use
	  it to set a timestamp in exported GPX files.

Tue Jan 14 01:18:42 GMT 2014  Olly Betts <olly@survex.com>

	* src/datain.c: Fix NULL pointer dereference when processing Compass
	  DAT file without 'SURVEY DATE:'.

Tue Jan 14 00:40:06 GMT 2014  Olly Betts <olly@survex.com>

	* src/: Add new "datestamp_numeric" field to struct img giving the
	  datestamp as a time_t in UTC (or (time_t)-1 if there's no datestamp
	  or we failed to convert it).  For .3d >= v8, this field is reliable.
	  We attempt to convert date strings in .3d <= v7 and CMAP XYZ
	  files, but may get the timezone wrong.

Tue Jan 14 00:29:35 GMT 2014  Olly Betts <olly@survex.com>

	* src/img.c: Fix my_strcasecmp() to handle top-bit set characters
	  better.

Mon Jan 13 04:20:11 GMT 2014  Olly Betts <olly@survex.com>

	* src/gpx.cc: Don't try to write the title if it isn't set or is
	  empty.

Mon Jan 13 04:09:27 GMT 2014  Olly Betts <olly@survex.com>

	* src/export.cc: If the survey has a title, add it as a top-level
	  <title> element to exported SVG files.

Mon Jan 13 04:08:11 GMT 2014  Olly Betts <olly@survex.com>

	* src/export.cc: Escape '<', '>', and '&' in labels in exported SVG
	  files.

Mon Jan 13 04:02:26 GMT 2014  Olly Betts <olly@survex.com>

	* src/: Pass the datestamp from the 3d file to the export code.

Mon Jan 13 04:00:54 GMT 2014  Olly Betts <olly@survex.com>

	* src/avenprcore.cc,src/printwx.cc: Don't bother looking up the
	  printer page setup info when exporting.

Wed Jan 08 04:50:10 GMT 2014  Olly Betts <olly@survex.com>

	* doc/HACKING.htm: Document how to configure wxWidgets 3.0.0 for mingw
	  cross-build.

Wed Jan 08 04:11:32 GMT 2014  Olly Betts <olly@survex.com>

	* NEWS,configure.ac: Update for 1.2.9.

Wed Jan 08 03:57:39 GMT 2014  Olly Betts <olly@survex.com>

	* lib/: Add "Language:" headers to .po files.

Wed Jan 08 02:17:44 GMT 2014  Olly Betts <olly@survex.com>

	* src/img.c: In non-hosted mode, don't define GETC and PUTC if they're
	  already defined, to allow easy overriding with getc_unlocked() and
	  putc_unlocked().

Wed Jan 08 02:13:27 GMT 2014  Olly Betts <olly@survex.com>

	* src/Makefile.am,src/imgtest.c: Add compile test that img.c and img.h
	  work in non-hosted mode.

Wed Jan 08 01:14:42 GMT 2014  Olly Betts <olly@survex.com>

	* doc/cavern.sgml: Document --3d-version in cavern man page.

Wed Jan 08 01:05:34 GMT 2014  Olly Betts <olly@survex.com>

	* src/moviemaker.cc: Set rc_buffer_size to avoid warning from libav
	  when exporting MPEG.

Tue Jan 07 23:09:53 GMT 2014  Olly Betts <olly@survex.com>

	* src/moviemaker.cc: Fix GCC warnings.

Tue Jan 07 23:08:21 GMT 2014  Olly Betts <olly@survex.com>

	* src/img.c: In non-hosted mode, check that int is at least 32 bits,
	  and if not, use long.  In practice, platforms with 16 bit int are
	  mostly obsolete, but it's not hard to be portable here.

Tue Jan 07 22:05:58 GMT 2014  Olly Betts <olly@survex.com>

	* src/msvc/config.h.in: Update to INT16_T to int16_t and INT32_T to
	  int32_t.  AFAIK, building with MSVC hasn't been tested for a long
	  time, so it's likely more fixes will be needed.

Tue Jan 07 21:55:27 GMT 2014  Olly Betts <olly@survex.com>

	* configure.ac: Don't call AC_C_CONST - C compilers without 'const'
	  support haven't been relevant for years.

Thu Oct 31 12:08:07 GMT 2013  Olly Betts <olly@survex.com>

	* lib/: Update translations from launchpad and from existing similar
	  messages.

Tue Oct 29 23:47:57 GMT 2013  Olly Betts <olly@survex.com>

	* src/moviemaker.cc: Fix to call avcodec_free_frame() correctly.

Tue Oct 29 08:58:56 GMT 2013  Olly Betts <olly@survex.com>

	* NEWS,configure.ac: Update for 1.2.8.

Tue Oct 29 08:10:45 GMT 2013  Olly Betts <olly@survex.com>

	* src/: Hook up to pass "input_projection" from .aven config file
	  through to GPX export code.

Sat Oct 26 06:35:52 GMT 2013  Olly Betts <olly@survex.com>

	* src/gfxcore.cc: Another tweak to use RefreshRect() rather than
	  Refresh() for slightly simpler code.

Fri Oct 25 21:08:53 GMT 2013  Olly Betts <olly@survex.com>

	* src/gpx.cc: Use fputs rather than fprintf for constant strings.

Fri Oct 25 21:07:57 GMT 2013  Olly Betts <olly@survex.com>

	* src/gpx.cc,src/gpx.h,src/printwx.cc: Add support for exporting legs
	  as tracks in GPX.

Fri Oct 25 06:14:38 GMT 2013  Olly Betts <olly@survex.com>

	* src/printwx.cc: Swap the "Elements" and "View" boxes in the print
	  and export dialogs, as that works much better when the "View" box
	  is hidden.

Fri Oct 25 06:11:59 GMT 2013  Olly Betts <olly@survex.com>

	* lib/survex.pot,src/export.cc,src/export.h,src/printwx.cc: Add
	  "Origin in centre" and "Full coordinates" options to export
	  - the latter fixes #10.  GPX and PLT output force "full
	  coordinates".

Wed Oct 23 21:47:07 GMT 2013  Olly Betts <olly@survex.com>

	* src/gfxcore.cc: Tweak to use RefreshRect() rather than Refresh() for
	  slightly simpler code.

Wed Oct 23 21:46:13 GMT 2013  Olly Betts <olly@survex.com>

	* src/dump3d.c: Show dates for XSECT.

Wed Oct 23 06:46:39 GMT 2013  Olly Betts <olly@survex.com>

	* src/printwx.cc: Fix export and (the built-in) print preview to
	  actually use the options selected in the dialog rather than those
	  set when the dialog was created.

Wed Oct 23 06:30:05 GMT 2013  Olly Betts <olly@survex.com>

	* src/: Hook up GPX export options to export entrances, fixed points,
	  and/or exported points, and specify coloured pin symbols for these
	  types of stations.  These options now default to what's being shown
	  in the survey view, like other export options.   GPX export
	  "creator" how includes the Survex version and website URL, and the
	  survey title is includes as a <name> tag inside the <gpx> tag.

Wed Oct 23 04:38:31 GMT 2013  Olly Betts <olly@survex.com>

	* src/guicontrol.cc: Fix assertion failure when double-clicking on the
	  survey with wx2.9.

Tue Oct 22 06:01:05 GMT 2013  Olly Betts <olly@survex.com>

	* src/: Rename internal references to "show splays" to just "splays"
	  to reflect the change in the menu item name.

Tue Oct 22 05:55:55 GMT 2013  Olly Betts <olly@survex.com>

	* lib/survex.pot,src/: Hide the "View" box for GPX export.  Add
	  checkboxes for "Entrances", "Fixed Points" and "Exported Stations"
	  for GPX export (currently non-functional).  Prepare for allowing
	  text height, marker size, and grid spacing to be set from aven (as
	  cad3d allows).

Mon Oct 21 01:10:04 GMT 2013  Olly Betts <olly@survex.com>

	* src/mainfrm.cc: Update to call img_error2msg() on the error code
	  returned by img_error().

Sat Oct 19 18:28:49 GMT 2013  Olly Betts <olly@survex.com>

	* src/printwx.cc: Fix segfault in "File->Export" if an export format
	  isn't stored in ".aven".

Sat Oct 19 17:39:49 GMT 2013  Olly Betts <olly@survex.com>

	* configure.ac,src/img.c: Use lround() instead of round(), and make
	  the tests around whether we use the library function or the our
	  fallback implementation saner.

Wed Sep 18 00:26:33 GMT 2013  Olly Betts <olly@survex.com>

	* src/aven.cc: Fix to build with wx 2.9.5 with wx2.8 compatibility
	  disabled.

Tue Sep 17 23:57:02 GMT 2013  Olly Betts <olly@survex.com>

	* src/mainfrm.cc: Make the Presentation->Play menu item a checkbox,
	  to avoid a warning with wxMSW 2.9.5.  Reported by Brian Clipstone.

Tue Sep 17 23:56:06 GMT 2013  Olly Betts <olly@survex.com>

	* src/guicontrol.cc,src/guicontrol.h: Rename scale/rotate lock
	  constants to have a "lock_" prefix.

Tue Sep 17 23:38:10 GMT 2013  Olly Betts <olly@survex.com>

	* src/mainfrm.cc: Make right click in an empty presentation mark the
	  current position and open it to edit, instead of crashing.

Tue Sep 17 23:37:00 GMT 2013  Olly Betts <olly@survex.com>

	* src/gfxcore.cc: Don't try to close the movie if we aren't producing
	  one.

Tue Sep 10 00:21:53 GMT 2013  Olly Betts <olly@survex.com>

	* configure.ac,src/moviemaker.cc: Use avcodec_free_frame() if it's
	  available.

Mon Sep 09 11:36:00 GMT 2013  Olly Betts <olly@survex.com>

	* src/cad3d.c: Correct long option names in code comment.

Mon Sep 09 11:33:20 GMT 2013  Olly Betts <olly@survex.com>

	* src/cad3d.c: Make --marker-size work for Skencil and SVG output.

Mon Sep 09 07:01:57 GMT 2013  Olly Betts <olly@survex.com>

	* src/gfxcore.cc,src/moviemaker.cc,src/moviemaker.h: Improve reporting
	  of errors during the process of exporting a movie.

Mon Sep 09 06:38:33 GMT 2013  Olly Betts <olly@survex.com>

	* configure.ac,src/moviemaker.cc,src/moviemaker.h: Update movie export
	  code to work with latest libav API.

Mon Sep 09 05:14:24 GMT 2013  Olly Betts <olly@survex.com>

	* Makefile.am,doc/HACKING.htm,lib/,survex.iss.in: Upgrade to newer
	  innosetup version.  Upgrade details of how to do a Microsoft Windows
	  build.

Mon Sep 09 04:19:36 GMT 2013  Olly Betts <olly@survex.com>

	* make_release: Prefer a hand-installed 2.9 mingw build of wx to a
	  packaged 2.8 build.

Mon Sep 09 04:18:18 GMT 2013  Olly Betts <olly@survex.com>

	* src/img.c,src/netbits.c: Fix // comments in C code for portability
	  to pre-C99 compilers which don't support these as an extension.

Mon Sep 09 04:12:57 GMT 2013  Olly Betts <olly@survex.com>

	* src/aven.cc: Fix to build with wxMSW 2.9.5.

Mon Sep 09 04:10:48 GMT 2013  Olly Betts <olly@survex.com>

	* configure.ac,src/Makefile.am: Probe for libproj.

Fri Sep 06 04:18:23 GMT 2013  Olly Betts <olly@survex.com>

	* NEWS,doc/cad3d.sgml,lib/,src/: The "Sketch" vector drawing program
	  got renamed to "Skencil" some time ago, so update all references in
	  code and documentation.  cad3d has a new --skencil option to specify
	  this output format, but --sketch is still recognised for
	  compatibility.

Fri Sep 06 03:39:16 GMT 2013  Olly Betts <olly@survex.com>

	* src/printwx.cc: Default to exporting in the export format used last
	  time.

Fri Sep 06 03:27:21 GMT 2013  Olly Betts <olly@survex.com>

	* lib/de_CH.po,lib/it.po,lib/sk.po: Minor translation updates.

Thu Sep 05 09:50:23 GMT 2013  Olly Betts <olly@survex.com>

	* lib/,src/: Add a format drop down to the export dialog, and only
	  show fields which are meaningful and supported for a particular
	  export format.

Thu Sep 05 04:21:40 GMT 2013  Olly Betts <olly@survex.com>

	* survex.iss.in: Newer innosetup no longer supports MinVersion.

Thu Sep 05 04:20:36 GMT 2013  Olly Betts <olly@survex.com>

	* lib/,survex.iss.in: Add translations for the Windows installer for
	  all the languages we have any translations of Survex itself for.

Mon Sep 02 21:03:50 GMT 2013  Olly Betts <olly@survex.com>

	* lib/,src/: Rework findentrances into GPX export for aven.

Mon Sep 02 02:17:49 GMT 2013  Olly Betts <olly@survex.com>

	* src/img.c: Improve fputsnl() for non-HOSTED mode to return a value.

Mon Sep 02 02:17:18 GMT 2013  Olly Betts <olly@survex.com>

	* src/img.c: Use osnew() to simplify code a little.

Mon Sep 02 01:45:52 GMT 2013  Olly Betts <olly@survex.com>

	* src/img.c: Don't segfault on img_close() in non-hosted mode.

Mon Sep 02 00:27:29 GMT 2013  Olly Betts <olly@survex.com>

	* NEWS,src/img.c: img.c can now be compiled as C++ as well as as C.

Mon Sep 02 00:17:36 GMT 2013  Olly Betts <olly@survex.com>

	* NEWS,src/img.c: Add missing definition of max() macro when built for
	  use outside of Survex.

Mon Sep 02 00:11:36 GMT 2013  Olly Betts <olly@survex.com>

	* src/img.c: Don't duplicate the IMG_API_VERSION defaulting logic from
	  img.h as we get it just by including img.h first.

Mon Sep 02 00:10:34 GMT 2013  Olly Betts <olly@survex.com>

	* src/: IMG_HOSTED no longer affects the img API at all.

Fri Aug 23 08:06:18 GMT 2013  Olly Betts <olly@survex.com>

	* NEWS,lib/,src/netskel.c: Tweak cavern .err file output to not lose
	  the space in front of certain statistics when the value gets large.

Wed Aug 21 21:14:03 GMT 2013  Olly Betts <olly@survex.com>

	* NEWS,lib/,src/matrix.c,src/out.h,tests/calibrate_clino.out: Don't
	  report "Solving to find x coordinates" as we actually find y and z
	  in the same operation, and as a progress message it is redundant with
	  "Solving %d simultaneous equations" anyway.

Fri Aug 09 10:23:24 GMT 2013  Olly Betts <olly@survex.com>

	* NEWS,src/printwx.cc: Need to call TransferDataFromWindow() for the
	  validators to get called and update the boolean flag settings mask.

Fri Aug 02 13:04:39 GMT 2013  Olly Betts <olly@survex.com>

	* NEWS,src/readval.c,tests/cmd_alias.out: Fix handling of anonymous
	  wall stations ('..' by default) to implicitly set the SPLAY leg flag,
	  as was intended.

Sat Jul 27 10:08:46 GMT 2013  Olly Betts <olly@survex.com>

	* tests/Makefile.am: Distribute files for normal_bad testcase.

Sat Jul 27 09:41:34 GMT 2013  Olly Betts <olly@survex.com>

	* NEWS,configure.ac: Update for 1.2.7.

Sun Jul 21 18:03:58 GMT 2013  Olly Betts <olly@survex.com>

	* src/mainfrm.cc: Speed up loading a .3d file with cross-sections by
	  using a map to convert station names to positions.

Sun Jul 21 16:12:25 GMT 2013  Olly Betts <olly@survex.com>

	* doc/TODO.htm: Note that dump3d needs documenting.

Sun Jul 21 16:09:24 GMT 2013  Olly Betts <olly@survex.com>

	* configure.ac,debian/survex.install,src/Makefile.am: Build and
	  package dump3d as standard - it's useful for grabbing info from
	  3d files in scripts.

Thu Jul 18 03:54:45 GMT 2013  Olly Betts <olly@survex.com>

	* lib/de.po: Merge German translation updates from launchpad.

Wed Jul 17 12:38:39 GMT 2013  Olly Betts <olly@survex.com>

	* doc/3dformat.htm,src/img.c: Move the DATE and ERROR codes in 3d v8 to
	  leave a large contiguous block of codes available.

Wed Jul 17 12:29:33 GMT 2013  Olly Betts <olly@survex.com>

	* src/img.c: Mask out the bit used to indicate no label change from
	  the returned leg flags.

Wed Jul 17 11:13:37 GMT 2013  Olly Betts <olly@survex.com>

	* doc/3dformat.htm,src/img.c: The prefix is often unchanged from one
	  leg to the next, so use a spare flag to compactly indicate that
	  there's no label change.

Tue Jul 16 12:04:55 GMT 2013  Olly Betts <olly@survex.com>

	* doc/3dformat.htm,src/img.c: More work toward v8 of 3d format.

Tue Jul 16 11:33:34 GMT 2013  Olly Betts <olly@survex.com>

	* doc/TODO.htm: The data style of legs is now stored in the 3d file,
	  so remove "flag nosurvey legs in .3d file" from todo list.

Tue Jul 16 11:33:04 GMT 2013  Olly Betts <olly@survex.com>

	* src/dump3d.c: Report the data style of legs.

Tue Jul 16 11:32:13 GMT 2013  Olly Betts <olly@survex.com>

	* src/cad3d.c: Check for errors from img_rewind() and report them.

Tue Jul 16 07:54:52 GMT 2013  Olly Betts <olly@survex.com>

	* tests/cavern.tst: Run diffpos <expected> <actual> so the reports of
	  'Added' and 'Deleted' stations are the more natural way round.

Tue Jul 09 22:59:48 GMT 2013  Olly Betts <olly@survex.com>

	* doc/3dformat.htm: Formatting tweaks.

Tue Jul 09 13:36:35 GMT 2013  Olly Betts <olly@survex.com>

	* doc/3dformat.htm,doc/TODO.htm,src/img.c: Add an explicit flag for
	  'this is an extended elevation' to 3d v8.

Tue Jul 09 13:24:29 GMT 2013  Olly Betts <olly@survex.com>

	* doc/3dformat.htm,doc/TODO.htm,src/img.h: Start on v8 of the 3d format
	  - the timestamp is stored as seconds since 1970.

Tue Jul 09 12:41:51 GMT 2013  Olly Betts <olly@survex.com>

	* src/commands.c: Fix ordering of the style masks to reflect swapping
	  of STYLE_NOSURVEY and STYLE_PASSAGE.

Tue Jul 09 11:14:28 GMT 2013  Olly Betts <olly@survex.com>

	* doc/TODO.htm: Update.

Tue Jul 09 10:31:50 GMT 2013  Olly Betts <olly@survex.com>

	* src/img.h: Remove unnecessary include of "useful.h" in IMG_HOSTED
	  mode.

Tue Jul 09 08:48:35 GMT 2013  Olly Betts <olly@survex.com>

	* src/cavern.h,src/img.h: Renumber STYLE_PASSAGE and STYLE_NOSURVEY so
	  that the style constants we want to pass to img are contiguously
	  numbered.

Sun Jul 07 13:03:56 GMT 2013  Olly Betts <olly@survex.com>

	* src/img.h: Just make fRead always int, eliminating IMG_HOSTED
	  conditional.

Sun Jul 07 12:45:11 GMT 2013  Olly Betts <olly@survex.com>

	* src/extend.c,src/img.c,src/img.h: Repurpose the long unused fBinary
	  parameter to img_open_write() as a flags parameter, and add
	  img_FFLAG_EXTENDED to specify that this is an extended elevation,
	  in place of appending " (extended)" to the title.  Internally we
	  still append this to the title (and remove it upon reading), but in
	  the 3d v8 format, the flags will be stored explicitly in the file.

Sun Jul 07 12:22:32 GMT 2013  Olly Betts <olly@survex.com>

	* src/img.h: Add comments for the lists of "Leg flags" and "Station
	  flags".

Sun Jul 07 12:20:29 GMT 2013  Olly Betts <olly@survex.com>

	* NEWS,src/dump3d.c,src/img.h: Drop img_FLAG_NOSURVEY - it's redundant
	  now we're going to store the style of each leg, and it hasn't yet
	  been in a release.

Sun Jul 07 12:14:23 GMT 2013  Olly Betts <olly@survex.com>

	* src/dump3d.c: Report if the file is an extended elevation.

Sun Jul 07 12:12:24 GMT 2013  Olly Betts <olly@survex.com>

	* src/: Track the data style of each leg, and pass it in to img - it's
	  not yet stored in the .3d file, but now it is easily available so it
	  can be.

Fri Jul 05 13:17:24 GMT 2013  Olly Betts <olly@survex.com>

	* configure.ac,doc/3dformat-old.htm: Split off a copy of the current
	  3dformat document - v8 will feature significant changes, so it will
	  be clearer to document it separately.

Fri Jul 05 13:11:25 GMT 2013  Olly Betts <olly@survex.com>

	* src/dump3d.c,src/netskel.c: The fBinary parameter of img_open_write()
	  has been unused for years, so stop passing fTrue.

Tue Jul 02 12:04:09 GMT 2013  Olly Betts <olly@survex.com>

	* src/img.c: Revert to putting a human readable timestamp string in
	  v7 and older files.

Tue Jul 02 11:01:41 GMT 2013  Olly Betts <olly@survex.com>

	* src/dump3d.c: Show only 2 decimal places on coordinates and passage
	  dimensions.

Wed Jun 12 13:35:21 GMT 2013  Olly Betts <olly@survex.com>

	* src/printwx.cc: Implement a copy ctor for BitValidator in the same
	  way that wxGenericValidator does.  Older GCC seems to need such a
	  copy ctor to exist to compile the uses of BitValidator in
	  printwx.cc.

Wed Jun 12 13:34:52 GMT 2013  Olly Betts <olly@survex.com>

	* src/Makefile.am: Ship gdtconvert and gen_img2aven.

Wed Jun 12 13:33:38 GMT 2013  Olly Betts <olly@survex.com>

	* make_release: Tweak 'mingw' building to look for a suitable
	  wx-config and get the C and C++ compilers to use using its
	  --cc and --cxx flags.

Tue Jun 11 12:06:08 GMT 2013  Olly Betts <olly@survex.com>

	* src/printwx.cc: wxValidator subclasses shouldn't have a copy ctor,
	  so give BitValidator an unimplemented private copy ctor, and use
	  the normal ctor instead to implement the Clone() method.

Tue Jun 11 11:51:13 GMT 2013  Olly Betts <olly@survex.com>

	* NEWS: Update from ChangeLog.

Mon Jun 10 11:50:18 GMT 2013  Olly Betts <olly@survex.com>

	* lib/launchpad-merge-po: New script to eliminate unwanted differences
	  introduced by launchpad.
	* lib/Makefile.am: Make launchpad-diff target use launchpad-merge-po
	  and skip files missing in the launchpad export.

Mon Jun 10 11:47:37 GMT 2013  Olly Betts <olly@survex.com>

	* lib/unlaunchpad-po: Normalise dates in PO headers.

Mon Jun 10 07:23:07 GMT 2013  Olly Betts <olly@survex.com>

	* lib/Makefile.am,lib/unlaunchpad-po: Add "launchpad-diff" make target
	  to assist with merging in translation changes from launchpad.

Sun Jun 09 00:04:37 GMT 2013  Olly Betts <olly@survex.com>

	* src/img.c: Handle .pos files containing unnamed stations - don't suck
	  the next line in as the station name, and set img_SFLAG_ANON for
	  them.

Sat Jun 08 15:12:25 GMT 2013  Olly Betts <olly@survex.com>

	* src/mainfrm.cc: Fix mapping of flags when loading a .3d file.

Sat Jun 08 15:07:05 GMT 2013  Olly Betts <olly@survex.com>

	* .gitignore,src/gen_img2aven: Commit script to generate img2aven.h.

Sat Jun 08 14:20:45 GMT 2013  Olly Betts <olly@survex.com>

	* lib/: Update line number references and merge message changes from
	  survex.pot to the .po files.

Sat Jun 08 14:17:52 GMT 2013  Olly Betts <olly@survex.com>

	* lib/Makefile.am,lib/merge-po: Add "merge-pos" target to merge in new
	  messages and updates to comments from survex.pot to the .po files.

Sat Jun 08 14:10:16 GMT 2013  Olly Betts <olly@survex.com>

	* tests/: Commit files for new tests.

Sat Jun 08 13:40:38 GMT 2013  Olly Betts <olly@survex.com>

	* src/img.c,src/img.h,src/mainfrm.cc: Store the 'processed at'
	  timestamp in the .3d file as seconds since 1970 rather than as
	  a human readable string.

Sat Jun 08 06:19:17 GMT 2013  Olly Betts <olly@survex.com>

	* src/commands.c: Correct comment about *alias.

Sat Jun 08 06:01:38 GMT 2013  Olly Betts <olly@survex.com>

	* lib/de.po,lib/de_CH.po,lib/en_US.po: Update translations.

Thu Jun 06 10:56:22 GMT 2013  Olly Betts <olly@survex.com>

	* lib/,src/: Show splay legs faded by default, with menu options to
	  hide them or show them like other legs.

Tue Jun 04 12:37:03 GMT 2013  Olly Betts <olly@survex.com>

	* doc/manual.sgml,lib/survex.pot,src/,tests/Makefile.am,
	  tests/cavern.tst: Add more anonymous station types - a double
	  separator ('..' by default) is an anoymous wall point at the end
	  of an implicit splay (c.f. '.' being a non-wall point), and
	  a triple separator ('...' by default) is an anoymous point (with
	  nothing special about the leg).  New *alias command allows '-' to be
	  mapped to '..' to match pocket topo conventions.  3d file format now
	  support a 'WALL' station flag.

Tue Jun 04 12:19:31 GMT 2013  Olly Betts <olly@survex.com>

	* src/Makefile.am: Regenerate gradient.pov is gdtconvert changes.

Sun Jun 02 12:51:46 GMT 2013  Olly Betts <olly@survex.com>

	* src/readval.c,tests/: Report column numbers as well as line numbers
	  for more cavern errors and warnings.  Add more testcases.  If the
	  argument to *include has an opening double quote but the closing
	  double quote is missing, then skip trying to open the file.

Sun Jun 02 10:52:26 GMT 2013  Olly Betts <olly@survex.com>

	* src/cavernlog.cc: Remove useless extra quoting when invoking vim.

Fri May 31 13:51:16 GMT 2013  Olly Betts <olly@survex.com>

	* src/netskel.c: Use fputs not printf to write literal string to avoid
	  GCC format security warning (the string can never contain a '%' but
	  the compiler can't see that).

Fri May 31 13:08:01 GMT 2013  Olly Betts <olly@survex.com>

	* src/datain.c: Variable 'len' in compile_error_token was static for no
	  good reason.

Fri May 31 12:32:22 GMT 2013  Olly Betts <olly@survex.com>

	* src/mainfrm.cc,src/mainfrm.h: Skip anonymous stations.

Fri May 31 12:17:56 GMT 2013  Olly Betts <olly@survex.com>

	* src/,tests/: Anonymous stations no longer have a made up unique name,
	  and are marked with a new ANON flag in .3d files.

Mon May 27 11:24:18 GMT 2013  Olly Betts <olly@survex.com>

	* configure.ac: Update copyright date.

Sun May 26 13:05:34 GMT 2013  Olly Betts <olly@survex.com>

	* src/: New station flag SFLAGS_USED to mark a station as "used" so we
	  don't issue "unused fixed point" warnings about it - previously we
	  set 'shape' to be negative to indicate this, but that required us to
	  handle that whenever we looked at or updated shape.

Sun May 26 11:47:06 GMT 2013  Olly Betts <olly@survex.com>

	* configure.ac: Fix sizeof(wxChar) test to work for wx2.9.

Fri May 10 05:55:54 GMT 2013  Olly Betts <olly@survex.com>

	* configure.ac,src/gla-gl.cc,src/glbitmapfont.h: It seems we need to
	  include GL/gl.h before we can safely include GL/glext.h (at least on
	  Debian wheezy).

Fri May 10 05:43:09 GMT 2013  Olly Betts <olly@survex.com>

	* configure.ac: Fix wxChar test to work in a non-cross-compiled build.

Wed May 08 22:38:56 GMT 2013  Olly Betts <olly@survex.com>

	* configure.ac,src/glbitmapfont.cc: Check sizeof(wxChar) at configure
	  time, so we can avoid a warning when sizeof(wxChar)==2 (which is the
	  case under mingw).

Wed May 08 05:54:23 GMT 2013  Olly Betts <olly@survex.com>

	* lib/en_US.po,lib/survex.pot: Update.

Tue May 07 23:30:26 GMT 2013  Olly Betts <olly@survex.com>

	* src/aven.cc: Don't crash trying to report an error after the app
	  object has been created but before the frame window has.

Sun Jan 06 19:31:30 GMT 2013  Olly Betts <olly@survex.com>

	* doc/manual.sgml: "surface topology" -> "surface topography".

Sun Jan 06 08:07:22 GMT 2013  Olly Betts <olly@survex.com>

	* lib/Makefile.am: Remove launchpad-tarball target - changes now
	  get picked up by launchpad automatically via a bzr mirror of the
	  git repo.

Sun Jan 06 05:45:10 GMT 2013  Olly Betts <olly@survex.com>

	* lib/survex.pot,src/dump3d.c: Add --show-dates/-d to --help output.

Sun Jan 06 05:42:07 GMT 2013  Olly Betts <olly@survex.com>

	* lib/po-to-msg.pl: Fix matching quote check to really allow
	  for using « and » in a translation.

Sun Jan 06 05:23:48 GMT 2013  Olly Betts <olly@survex.com>

	* src/dump3d.c: Report img_STOP as STOP rather than CODE_0xffffffff.

Thu Jan 03 01:08:28 GMT 2013  Olly Betts <olly@survex.com>

	* src/: Use wxValidator to simplify keeping svxPrintDlg member
	  variables and fields in the dialog in sync.

Wed Jan 02 20:49:20 GMT 2013  Olly Betts <olly@survex.com>

	* src/gla-gl.cc,src/glbitmapfont.cc: Add checks for errors when reading
	  the font file.

Wed Jan 02 20:48:22 GMT 2013  Olly Betts <olly@survex.com>

	* configure.ac,src/img.c: Avoid warning about redeclaration of round().

Wed Jan 02 09:11:41 GMT 2013  Olly Betts <olly@survex.com>

	* src/readval.c: Whitespace tweak.

Wed Jan 02 09:10:57 GMT 2013  Olly Betts <olly@survex.com>

	* src/netartic.c: Use TSTBIT(w, x) instead of w & BIT(x).

Wed Jan 02 09:10:30 GMT 2013  Olly Betts <olly@survex.com>

	* src/listpos.c: Fix compiler warning.

Wed Jan 02 09:04:58 GMT 2013  Olly Betts <olly@survex.com>

	* lib/survex.pot,src/,tests/: Add support for anonymous stations,
	  which are indicated by a station name of '.'.

Sat Dec 29 18:50:07 GMT 2012  Olly Betts <olly@survex.com>

	* src/export.cc: Implement export of passage info for DXF (untested).

Sat Dec 29 05:29:31 GMT 2012  Olly Betts <olly@survex.com>

	* src/gfxcore.cc,src/printwx.cc,src/printwx.h: Default the export/print
	  settings for passage related things to the "tubes" setting in the
	  OpenGL view.

Sat Dec 29 05:11:20 GMT 2012  Olly Betts <olly@survex.com>

	* src/gfxcore.cc,src/gfxcore.h: Export of passage detail now works
	  before we have displayed tubes in the OpenGL view.

Sat Dec 29 05:09:54 GMT 2012  Olly Betts <olly@survex.com>

	* src/avenprcore.cc,src/avenprcore.h,src/printwx.cc: Do away with the
	  separate bool flags for each thing we can show in printing and export
	  and just use the "show_mask" flags.

Fri Dec 28 23:30:55 GMT 2012  Olly Betts <olly@survex.com>

	* lib/: Fill in new messages from existing translations where possible.

Fri Dec 28 21:03:33 GMT 2012  Olly Betts <olly@survex.com>

	* lib/: Merge from survex.pot to .po files.

Fri Dec 28 22:21:50 GMT 2012  Olly Betts <olly@survex.com>

	* lib/survex.pot: Update locations.

Fri Dec 28 22:19:14 GMT 2012  Olly Betts <olly@survex.com>

	* src/printwx.cc: Disable passage-related export options when in a
	  tilted view.  Hook up "Cross-sections" to printing on left and
	  right markers.

Fri Dec 28 06:30:17 GMT 2012  Olly Betts <olly@survex.com>

	* lib/survex.pot,src/: Add options to export dialog to control showing
	  cross-sections, walls and passages.

Fri Dec 28 05:53:56 GMT 2012  Olly Betts <olly@survex.com>

	* src/: Implement exporting of passages (ticket#4) for SVG.  Currently
	  it is always on (I'll update the Export dialog shortly).

Wed Dec 26 22:21:10 GMT 2012  Olly Betts <olly@survex.com>

	* lib/survex.pot,src/commands.c,src/readval.c,src/readval.h,tests/: Add
	  new warning if *begin SURVEY has a separator character in SUVERY.

Wed Dec 26 07:29:42 GMT 2012  Olly Betts <olly@survex.com>

	* lib/en_US.po: Fix clashing menu accelerator.

Wed Dec 26 01:46:06 GMT 2012  Olly Betts <olly@survex.com>

	* src/readval.c: Fix typo in previous change.

Tue Dec 25 23:04:06 GMT 2012  Olly Betts <olly@survex.com>

	* src/readval.c,tests/: Demote errors about invalid dates to warnings,
	  since we've accepted *date for ages without any checks on the value,
	  and so existing datasets probably contain invalid dates and dates in
	  other formats.  (ticket#19)

Tue Dec 25 22:03:20 GMT 2012  Olly Betts <olly@survex.com>

	* src/listpos.c: But always leave space for at least 4 digits, so we
	  give exactly the same output as before unless we need the extra
	  width.

Mon Dec 24 08:44:04 GMT 2012  Olly Betts <olly@survex.com>

	* src/listpos.c: Adjust width of node stats table to fit longest count.

Sun Dec 23 07:20:53 GMT 2012  Olly Betts <olly@survex.com>

	* lib/survex.pot: Wrap TRANSLATORS comment.

Sun Dec 23 07:20:19 GMT 2012  Olly Betts <olly@survex.com>

	* lib/survex.pot: Add missing "c-format" annotation.

Sun Dec 23 07:19:22 GMT 2012  Olly Betts <olly@survex.com>

	* lib/sk.po: Resolve a couple of inconsistencies in translation of
	  similar messages by asking Martin Sluka.

Sun Dec 23 05:36:38 GMT 2012  Olly Betts <olly@survex.com>

	* NEWS: Update from ChangeLog.

Thu Dec 20 04:31:22 GMT 2012  Olly Betts <olly@survex.com>

	* lib/zh_CN.po: Translate another message.

Thu Dec 20 03:28:02 GMT 2012  Olly Betts <olly@survex.com>

	* lib/zh_CN.po: Add space after colon.

Thu Dec 20 03:26:15 GMT 2012  Olly Betts <olly@survex.com>

	* lib/survex.pot: Add more TRANSLATORS comments about terminology.

Thu Dec 20 03:25:45 GMT 2012  Olly Betts <olly@survex.com>

	* lib/it.po: Merge two new translations from launchpad.

Thu Dec 20 03:24:52 GMT 2012  Olly Betts <olly@survex.com>

	* lib/en_US.po: Correct "leg" to "shot" in a few places, and translate
	  "Anticlockwise" to "Counterclockwise".

Wed Dec 19 10:41:55 GMT 2012  Olly Betts <olly@survex.com>

	* lib/po-to-msg.pl: Remove commented out code to find uses, which is
	  now handled by a separate script.

Wed Dec 19 10:36:59 GMT 2012  Olly Betts <olly@survex.com>

	* lib/po-to-msg.pl: Update to read message numbers from references.

Tue Dec 18 12:00:40 GMT 2012  Olly Betts <olly@survex.com>

	* src/gla-gl.cc,src/gla.h: Update to use wxGLContext to avoid
	  deprecation warnings from wx 2.9.

Tue Dec 18 11:40:34 GMT 2012  Olly Betts <olly@survex.com>

	* src/moviemaker.cc: Fix unused parameter warnings when we don't have
	  libavformat available.

Tue Dec 18 11:39:40 GMT 2012  Olly Betts <olly@survex.com>

	* src/glbitmapfont.cc: Fix warning about ambiguous else from wxLogError
	  macro.

Tue Dec 18 11:32:32 GMT 2012  Olly Betts <olly@survex.com>

	* INSTALL,lib/INSTALL.OSX,src/,survex.spec.in: Require at least
	  wxWidgets 2.8.0 - it was released just over 6 years ago now,
	  and the wx developers consider even 2.8 to be rather long in
	  the tooth.  I haven't test build with wx 2.6 for more than a year
	  and it's no longer packaged for Debian.  Dropping support for
	  older wx allows a number of workarounds to be removed.

Tue Dec 18 11:05:24 GMT 2012  Olly Betts <olly@survex.com>

	* src/: Fix uses of some wx features which are deprecated in wx2.9.

Tue Dec 18 10:50:28 GMT 2012  Olly Betts <olly@survex.com>

	* src/gfxcore.cc,src/gla-gl.cc,src/gla.h: Fix OnSize handling
	  so we can just call event.Skip() (which is the intended approach)
	  rather than explicitly calling the parent class OnSize() method
	  from the subclass OnSize() method.

Tue Dec 18 08:23:14 GMT 2012  Olly Betts <olly@survex.com>

	* src/aven.cc: Fix MSW build to not rely on a GCC extension.

Tue Dec 18 07:20:16 GMT 2012  Olly Betts <olly@survex.com>

	* lib/: Merge changes from template.

Tue Dec 18 07:06:41 GMT 2012  Olly Betts <olly@survex.com>

	* lib/,src/Makefile.am,src/gettexttomsg.pl: Eliminate po_codes and just
	  store the message numbers as the line number in a fake source
	  reference to file 'n'.

Tue Dec 18 04:13:18 GMT 2012  Olly Betts <olly@survex.com>

	* lib/po_codes,lib/survex.pot: Merge in updated source line numbers.

Tue Dec 18 04:11:09 GMT 2012  Olly Betts <olly@survex.com>

	* lib/extract-msgs.pl,src/Makefile.am: Don't include version in
	  'Project-Id-Version'.

Tue Dec 18 03:13:16 GMT 2012  Olly Betts <olly@survex.com>

	* lib/: Set Project-Id-Version to just "survex" - the version part just
	  complicates things unnecessarily for our usage.

Tue Dec 18 03:00:04 GMT 2012  Olly Betts <olly@survex.com>

	* tests/Makefile.am,tests/aven.tst: Add new testsuite script (aven.tst)
	  which currently has regression tests for the recently fixed segfault
	  when aven didn't have messages for the requested language.

Tue Dec 18 02:19:08 GMT 2012  Olly Betts <olly@survex.com>

	* src/message.c: Only use ASCII for the handful of hardcoded messages
	  we need for errors loading message files, as it's probably more
	  likely the wrong encoding will be set in such cases.

Tue Dec 18 02:02:57 GMT 2012  Olly Betts <olly@survex.com>

	* src/,tests/: Report column numbers as well as line numbers for some
	  cavern errors and warnings, and update aven's cavern log parser to
	  handle these.  Simplify handling of quantity lists to only recognise
	  'DEFAULT' as the first item.  Add more testcases, expand some
	  existing testcases, and expected output for more.

Mon Dec 17 22:19:21 GMT 2012  Olly Betts <olly@survex.com>

	* src/message.c: If we don't find the message file, only give an error
	  if it was specified with SURVEX_LANG, since that is an explicit
	  instruction to Survex, whereas LANG, LC_ALL and LC_MESSAGES are
	  essentially system "preferred locale" settings.
	* src/aven.cc: Fix reporting of errors from message.c not to crash if
	  the wxApp object hasn't yet been intitialised, and to convert the
	  character encoding correctly.

Mon Dec 17 22:17:00 GMT 2012  Olly Betts <olly@survex.com>

	* lib/Makefile.am: Install zh_CN (Chinese) messages.

Mon Dec 17 22:02:43 GMT 2012  Olly Betts <olly@survex.com>

	* lib/zh_CN.po: Reuse existing translation of "Presentation" for the
	  top level menu name - now all the whole menu bar is translated!

Mon Dec 17 11:07:00 GMT 2012  Olly Betts <olly@survex.com>

	* src/cavernlog.cc: Don't highlight a file:linenumber if there's no
	  message after it, which avoids highlighting the "Included from"
	  lines wrongly.

Mon Dec 17 11:04:36 GMT 2012  Olly Betts <olly@survex.com>

	* tests/: Rename testcase badinc3 to badinc4 and actually run it, and
	  add new badinc3 which tests multiple levels of *include.  Add expect
	  output for all the badinc testcases.

Mon Dec 17 11:01:02 GMT 2012  Olly Betts <olly@survex.com>

	* src/datain.c: Report the parent include files starting from the
	  outermost, as that's more logical when there are multiple levels
	  involved.

Mon Dec 17 10:39:14 GMT 2012  Olly Betts <olly@survex.com>

	* lib/fr.po: Add translation for new message, adapted from two similar
	  existing messages.

Mon Dec 17 10:37:12 GMT 2012  Olly Betts <olly@survex.com>

	* lib/it.po: Merge a translation from launchpad.

Mon Dec 17 09:11:09 GMT 2012  Olly Betts <olly@survex.com>

	* lib/: Merge changes from .pot to .po files.

Mon Dec 17 06:37:10 GMT 2012  Olly Betts <olly@survex.com>

	* lib/,src/datain.c: Move the <filename>:<line> into the message when
	  reporting the include route to the file with the error in it, which
	  allows a more natural translation into German.

Mon Dec 17 03:26:40 GMT 2012  Olly Betts <olly@survex.com>

	* .gitignore: Add src/dump3d.

Mon Dec 17 03:24:22 GMT 2012  Olly Betts <olly@survex.com>

	* lib/po_codes,lib/po_codes_dead: Prune strings we aren't using and are
	  probably unlikely to use again into a new file po_codes_dead, so that
	  translators don't get presented with them to translate.
	* lib/survex.pot: Regenerate.

Tue Dec 11 23:07:31 GMT 2012  Olly Betts <olly@survex.com>

	* src/datain.c,tests/: We want to warn if there's a clino reading which
	  it would be impossible to have read from the instrument (e.g. on a
	  -90 to 90 degree scale you can't read "96" (it's probably a typo for
	  "69").  However, the gradient reading from a topofil is typically in
	  the range 0 to 180, with 90 being horizontal.  Really we should allow
	  the valid range to be specified, but for now we infer it from the
	  zero error - if this is within 45 degrees of 90 then we assume the
	  range is 0 to 180.

Tue Dec 11 22:29:35 GMT 2012  Olly Betts <olly@survex.com>

	* lib/po-to-msg.pl: Report unused message numbers.

Tue Dec 11 22:22:20 GMT 2012  Olly Betts <olly@survex.com>

	* lib/po_codes,lib/survex.pot,src/commands.c,tests/: If the scale
	  factor in *calibrate is zero, flag that as an error - it doesn't
	  make sense and probably means someone reversed the arguments to
	  *calibrate.

Mon Dec 03 06:52:22 GMT 2012  Olly Betts <olly@survex.com>

	* src/readval.c: If we were expecting a numeric field and instead get
	  something which starts with '+', '-', or '.' but which isn't a
	  number, then fix the error to include that character in the token
	  reported.
	* tests/: Add regression test badreadingdotplus.

Mon Dec 03 06:50:51 GMT 2012  Olly Betts <olly@survex.com>

	* tests/cavern.tst,tests/equatenosuchstn.out,tests/surveytypo.out: Stop
	  trimming output header when we get to copyright line, as there may be
	  an error before the first blank line.

Mon Dec 03 06:34:20 GMT 2012  Olly Betts <olly@survex.com>

	* tests/badinc3.svx: Add new test file, missed in earlier commit.

Mon Dec 03 04:18:34 GMT 2012  Olly Betts <olly@survex.com>

	* src/cavern.c: Use /* */ comments, not //.

Mon Dec 03 04:16:40 GMT 2012  Olly Betts <olly@survex.com>

	* tests/Makefile.am: Add new test suite files.

Mon Dec 03 04:13:32 GMT 2012  Olly Betts <olly@survex.com>

	* src/datain.c,tests/cavern.tst: Fix handling after reporting an error
	  for a bad reading in passage data to not then complain "End of line
	  not blank" but instead check other readings on the same line.
	* tests/passagebad.svx: Add regression testcase.

Mon Dec 03 02:55:33 GMT 2012  Olly Betts <olly@survex.com>

	* tests/cavern.tst,tests/extend.tst,tests/smoke.tst: Add valgrind hooks
	  to the rest of the tests scripts.

Mon Dec 03 02:53:56 GMT 2012  Olly Betts <olly@survex.com>

	* configure.ac: Fix package name, broken during modernisation of
	  autotools use.

Mon Dec 03 02:32:01 GMT 2012  Olly Betts <olly@survex.com>

	* tests/: Run tools under valgrind in most test scripts if VALGRIND is
	  set.

Mon Dec 03 02:29:56 GMT 2012  Olly Betts <olly@survex.com>

	* tests/smoke.tst: Remove variables which aren't ever used.

Mon Dec 03 02:28:45 GMT 2012  Olly Betts <olly@survex.com>

	* tests/: Make all test scripts report "Test passed" at the end if
	  VERBOSE is set and all testcases in the script passed.

Mon Dec 03 01:59:04 GMT 2012  Olly Betts <olly@survex.com>

	* tests/cavern.tst: If VALGRIND is set, run cavern under valgrind and
	  fail the test if there's an error.

Mon Dec 03 01:29:39 GMT 2012  Olly Betts <olly@survex.com>

	* src/datain.c: Refactor to avoid duplicating code for handling clino
	  and backclino.

Mon Dec 03 01:29:05 GMT 2012  Olly Betts <olly@survex.com>

	* src/datain.c: Check r is valid before using it at all.

Sun Dec 02 23:48:05 GMT 2012  Olly Betts <olly@survex.com>

	* src/str.c,src/str.h: Inline s_zero() and s_free() since they should
	  optimise down to similar or less code than a function call would.

Sun Dec 02 23:47:21 GMT 2012  Olly Betts <olly@survex.com>

	* src/datain.c: s_zero() on a NULL pointer is a no-op, so remove.

Sun Dec 02 22:53:34 GMT 2012  Olly Betts <olly@survex.com>

	* lib/de_CH.po: Consistently use Swiss quoting style.

Sun Dec 02 22:51:53 GMT 2012  Olly Betts <olly@survex.com>

	* src/readval.c: If we're about to longjmp to jbSkipLine, then we can
	  just call compile_error() instead of compile_error_skip().

Sun Dec 02 22:40:07 GMT 2012  Olly Betts <olly@survex.com>

	* src/datain.c: Always skip the current line if we longjmp to
	  jbSkipLine.
	* tests/cavern.tst,tests/skipafterbadomit.svx: We weren't skipping
	  after complaining about OMIT for a required reading, which the
	  change to always skip fixes, so add a regression test for that.

Sat Dec 01 23:42:22 GMT 2012  Olly Betts <olly@survex.com>

	* src/readval.c: Add a "const".

Fri Nov 30 00:31:16 GMT 2012  Olly Betts <olly@survex.com>

	* lib/it.po,lib/sk.po: Merge more updates from launchpad.

Wed Nov 28 06:11:11 GMT 2012  Olly Betts <olly@survex.com>

	* NEWS: Update from ChangeLog.

Wed Nov 28 05:02:26 GMT 2012  Olly Betts <olly@survex.com>

	* lib/de.po: A few more translations from launchpad.

Wed Nov 28 01:56:49 GMT 2012  Olly Betts <olly@survex.com>

	* lib/,src/sorterr.c: Change "HOW MANY" to "HOW_MANY" to make it
	  clearer this is a placeholder for one argument.

Wed Nov 28 01:52:16 GMT 2012  Olly Betts <olly@survex.com>

	* src/message.c: Don't force Latin 1 if setlocale(LC_MESSAGES, ...)
	  fails.

Wed Nov 28 01:51:11 GMT 2012  Olly Betts <olly@survex.com>

	* src/message.c: Transliterate « and » to " if we don't have them in
	  the current character set (previously we mapped them to << and >>).

Wed Nov 28 01:00:53 GMT 2012  Olly Betts <olly@survex.com>

	* lib/: Merge translations from launchpad.

Wed Nov 28 00:44:36 GMT 2012  Olly Betts <olly@survex.com>

	* lib/de_CH.po: Fill gaps from de.po.

Wed Nov 28 00:44:05 GMT 2012  Olly Betts <olly@survex.com>

	* lib/de.po: Merge in new "TRANSLATORS" comments.

Wed Nov 28 00:43:39 GMT 2012  Olly Betts <olly@survex.com>

	* lib/es.po,lib/fr.po,lib/it.po: Merge translations from launchpad.

Wed Nov 28 00:11:07 GMT 2012  Olly Betts <olly@survex.com>

	* lib/pt_BR.po: Merge translations from launchpad.

Wed Nov 28 00:00:18 GMT 2012  Olly Betts <olly@survex.com>

	* lib/po-to-msg.pl: Add FIXME to only check % formats for messages
	  which have the "c-format" flag set.

Tue Nov 27 23:57:25 GMT 2012  Olly Betts <olly@survex.com>

	* lib/po-to-msg.pl: Fix quote check to handle “” vs »«.

Tue Nov 27 23:40:06 GMT 2012  Olly Betts <olly@survex.com>

	* lib/de.po,lib/po_codes,lib/survex.pot: Reorder messages so the ones
	  in the "View" menu are together in order.  Adjust menu accelerators
	  for the German translation to avoid clashes in the View menu.

Tue Nov 27 23:14:05 GMT 2012  Olly Betts <olly@survex.com>

	* lib/de.po: Merge more updates from launchpad.

Tue Nov 27 22:30:36 GMT 2012  Olly Betts <olly@survex.com>

	* lib/de.po: Merge updates from launchpad.

Wed Nov 14 05:50:47 GMT 2012  Olly Betts <olly@survex.com>

	* lib/fr.po: Merge in new translator comments.

Sun Nov 04 21:26:29 GMT 2012  Olly Betts <olly@survex.com>

	* lib/sk.po: Merge changes from Martin Sluka.

Sun Nov 04 21:26:01 GMT 2012  Olly Betts <olly@survex.com>

	* lib/ca.po: Merge in TRANSLATOR comments.

Sun Nov 04 21:25:40 GMT 2012  Olly Betts <olly@survex.com>

	* lib/fr.po: Fix clashing menu accelerator.

Fri Nov 02 04:02:16 GMT 2012  Olly Betts <olly@survex.com>

	* NEWS: Update from ChangeLog.

Fri Nov 02 03:58:12 GMT 2012  Olly Betts <olly@survex.com>

	* lib/mailmsgs.pl: Remove obsolete script.
	* lib/Makefile.am,lib/po-to-msg.pl: Remove references to *.todo, which
	  we no longer generate.

Fri Nov 02 03:46:59 GMT 2012  Olly Betts <olly@survex.com>

	* lib/survex.pot: Add another TRANSLATORS comment.

Fri Nov 02 03:25:52 GMT 2012  Olly Betts <olly@survex.com>

	* lib/survex.pot: Add TRANSLATORS comments to clarify messages which
	  Eric asked about.

Fri Nov 02 03:06:00 GMT 2012  Olly Betts <olly@survex.com>

	* lib/: Merge translation updates.

Fri Nov 02 00:32:35 GMT 2012  Olly Betts <olly@survex.com>

	* src/guicontrol.cc,src/mainfrm.cc: On OS X, F11 is used by the desktop
	  so change the menu shortcut for "Full Screen Mode" to be the OS X
	  standard shortcut Shift-Command-F.

Sun Oct 28 04:21:27 GMT 2012  Olly Betts <olly@survex.com>

	* lib/sk.po: Merge updates from Martin Sluka.

Mon Oct 15 04:19:57 GMT 2012  Olly Betts <olly@survex.com>

	* Makefile.am,configure.ac: Modern automake seems to cope with files
	  required by GNU being generated during the build, so we no longer
	  need to use the "foreign" automake mode.  Also use -Werror with
	  automake.

Mon Oct 15 02:28:46 GMT 2012  Olly Betts <olly@survex.com>

	* src/Makefile.am: Remove workaround for GCC 2.95 failing to compile
	  gfxcore.cc - GCC 2.95 is obsolete now.

Mon Oct 15 02:27:04 GMT 2012  Olly Betts <olly@survex.com>

	* src/Makefile.am: Use AM_CPPFLAGS instead of obsolete INCLUDES.

Mon Oct 15 02:21:53 GMT 2012  Olly Betts <olly@survex.com>

	* Makefile.am,buildmacosx.sh,configure.ac,lib/mailmsgs.pl: Update
	  configure.ac from passing version to AM_INIT_AUTOMAKE to passing it
	  to AC_INIT, and fix places which grep out the version.

Mon Oct 15 02:08:23 GMT 2012  Olly Betts <olly@survex.com>

	* buildmacosx.sh,configure.ac,configure.in,doc/Makefile.am,
	  lib/mailmsgs.pl: Rename configure.in to configure.ac to make modern
	  autotools usage.

Thu Sep 27 10:41:56 GMT 2012  Olly Betts <olly@survex.com>

	* src/: Switch read_prefix_*() family of functions to be a single
	  read_prefix() function which tags a bitmask of flags.

Thu Sep 27 09:23:41 GMT 2012  Olly Betts <olly@survex.com>

	* lib/id.po: Resolve clashing menu accelerators.

Thu Sep 27 05:37:18 GMT 2012  Olly Betts <olly@survex.com>

	* src/namecompare.cc: Fix to build with wx2.8.

Thu Sep 27 05:25:49 GMT 2012  Olly Betts <olly@survex.com>

	* NEWS: Update from ChangeLog.

Thu Sep 27 05:12:22 GMT 2012  Olly Betts <olly@survex.com>

	* src/message.c: For determining character set on Unix, check LANG
	  after LC_ALL and LC_CTYPE.  For determining language, check LC_ALL
	  before LC_MESSAGES and LANG.

Thu Sep 27 04:48:34 GMT 2012  Olly Betts <olly@survex.com>

	* lib/id.po: Add more translations and fix marking of unused messages.

Thu Sep 27 04:07:24 GMT 2012  Olly Betts <olly@survex.com>

	* lib/Indonesian-5.1.11.isl,lib/Makefile.am,lib/id.po: Add start of
	  Indonesian translation from launchpad.

Thu Sep 27 03:56:22 GMT 2012  Olly Betts <olly@survex.com>

	* lib/: Merge translation updates from launchpad.

Thu Sep 27 00:31:24 GMT 2012  Olly Betts <olly@survex.com>

	* lib/: Remove scripts and data files which are no longer used.

Sat Sep 22 05:06:23 GMT 2012  Olly Betts <olly@survex.com>

	* src/mainfrm.cc,src/mainfrm.h: Don't run incremental search on every
	  key-press, as on a slow machine the short initial search(es) will
	  take a while but not be useful.  Instead set a flag, and actually
	  run the search when MainFrm next receives an idle event.

Fri Sep 21 06:24:32 GMT 2012  Olly Betts <olly@survex.com>

	* src/img.h: New leg flag img_FLAG_NOSURVEY.
	* src/netskel.c: Set img_FLAG_NOSURVEY for nosurvey legs.
	* src/dump3d.c: Report NOSURVEY leg flag.

Fri Sep 21 06:22:29 GMT 2012  Olly Betts <olly@survex.com>

	* src/Makefile.am: dump3d now needs date.c.

Wed Sep 19 22:12:35 GMT 2012  Olly Betts <olly@survex.com>

	* src/dump3d.c: Add --show-dates option.

Fri Sep 07 11:39:06 GMT 2012  Olly Betts <olly@survex.com>

	* src/namecompare.cc,src/namecompare.h: Add two new files which were
	  in the last release but I failed to commit.

Tue Aug 14 09:42:43 GMT 2012  Olly Betts <olly@survex.com>

	* lib/Makefile.am: Create de_DE.po as a symlink if it doesn't exist.

Mon May 28 16:56:27 GMT 2012  Olly Betts <olly@survex.com>

	* configure.in: -W no longer seems to cause problems with wxWidgets.

Mon May 28 16:49:37 GMT 2012  Olly Betts <olly@survex.com>

	* src/: Remove unused parameter names.

Sun May 27 12:24:17 GMT 2012  Olly Betts <olly@survex.com>

	* src/export.cc: Include "export.h".

Fri May 25 14:20:24 GMT 2012  Olly Betts <olly@survex.com>

	* tests/cavern.tst,test/equatenosuchstn.out: Drop line reporting time
	  taken when comparing output, as that can vary.
	* src/listpos.c,tests/equatenosuchstn.out: Move "Station X referred to
	  just once" warning after non-existent survey check.
	* src/,tests/: If survey isn't all connected, still run survey tree
	  checks and report errors and/or warnings which might suggest typo
	  locations.

Tue Feb 28 00:41:15 GMT 2012  Olly Betts <olly@survex.com>

	* tests/diffpos.tst: Force English messages for diffpos tests too.

Tue Feb 28 00:39:45 GMT 2012  Olly Betts <olly@survex.com>

	* tests/cavern.tst: Force English messages so comparing expected output
	  works whatever the current language setting.

Fri Feb 24 00:43:04 GMT 2012  Olly Betts <olly@survex.com>

	* tests/cavern.tst,tests/equatenosuchstn.out: Fix test failure due to
	  Survex version number appearing in expected output.

Thu Feb 23 22:34:52 GMT 2012  Olly Betts <olly@survex.com>

	* make_release: Link mingw build statically to avoid needing libgcc
	  DLL.

Wed Feb 22 23:39:25 GMT 2012  Olly Betts <olly@survex.com>

	* configure.in,src/gla-gl.cc: The Debian mingw-w64 packages lack
	  GL/glext.h so test for it in configure.

Wed Feb 22 23:29:29 GMT 2012  Olly Betts <olly@survex.com>

	* src/cavernlog.cc: Remove variable which is only assigned to and
	  never read.

Wed Feb 22 22:09:02 GMT 2012  Olly Betts <olly@survex.com>

	* NEWS,src/Makefile.am: Disable building findentrances by default
	  so I can get 1.2.6 out without further delays as it fixes processing
	  .svx files from aven under Mac OS X.

Wed Feb 22 11:35:40 GMT 2012  Olly Betts <olly@survex.com>

	* src/datain.c: Remove return type from data_normal() etc as we never
	  use it.

Wed Feb 22 05:11:53 GMT 2012  Olly Betts <olly@survex.com>

	* make_release: Update to work with Debian mingw-w64 packages.

Mon Feb 20 05:08:26 GMT 2012  Olly Betts <olly@survex.com>

	* NEWS,configure.in: Update for 1.2.6.

Sun Feb 19 10:48:37 GMT 2012  Olly Betts <olly@survex.com>

	* doc/3dformat.htm: Merge in some improvements from Mike McCombe.

Fri Feb 17 03:49:59 GMT 2012  Olly Betts <olly@survex.com>

	* src/message.c: Fix so that cavern run by aven finds its messages.

Thu Feb 16 01:36:54 GMT 2012  Olly Betts <olly@survex.com>

	* Makefile.am,survex.iss.in: Include JPG images in Innosetup installer.
	  (ticket#35)

Fri Jan 27 13:30:54 GMT 2012  Olly Betts <olly@survex.com>

	* lib/po_codes,lib/survex.pot,src/Makefile.am,src/findentrances.cc:
	  Make all messages in findentrances translatable.

Fri Jan 27 11:03:28 GMT 2012  Olly Betts <olly@survex.com>

	* lib/po_codes,lib/survex.pot,src/listpos.c,tests/: If we have a
	  reference to a station in a non-existent survey, give a helpful error
	  rather than saying the station hasn't been exported from the survey.

Tue Jan 24 23:03:10 GMT 2012  Olly Betts <olly@survex.com>

	* src/cavern.c: Remove TRANSLATE comment which has already been
	  addressed.

Tue Jan 24 10:56:14 GMT 2012  Olly Betts <olly@survex.com>

	* src/findentrances.cc: Add commenting noting precision of lat and lon.

Tue Jan 24 10:55:19 GMT 2012  Olly Betts <olly@survex.com>

	* src/findentrances.cc: Don't include carriage returns in .gpx output.

Tue Jan 24 10:42:41 GMT 2012  Olly Betts <olly@survex.com>

	* src/findentrances.cc: Add GPL licence boilerplate (Olaf OKed this in
	  <20120111115239.1b162450@ghost>).

Tue Jan 24 04:53:30 GMT 2012  Olly Betts <olly@survex.com>

	* src/Makefile.am,src/findentrances.cc: Build findentrances in the
	  buildsystem.

Tue Jan 24 04:41:03 GMT 2012  Olly Betts <olly@survex.com>

	* src/findentrances.cc: Update examples of usage to reflect "-s"
	  change.

Tue Jan 24 04:38:11 GMT 2012  Olly Betts <olly@survex.com>

	* src/findentrances.cc: Use string::assign() rather than constructing
	  a temporary string object and assigning that.

Tue Jan 24 04:35:25 GMT 2012  Olly Betts <olly@survex.com>

	* src/cmdline.c: Allow help argument to cmdline_init() to be NULL.

Tue Jan 24 04:35:04 GMT 2012  Olly Betts <olly@survex.com>

	* src/findentrances.cc: Support --help and --version options.

Tue Jan 24 04:27:15 GMT 2012  Olly Betts <olly@survex.com>

	* src/findentrances.cc: "using namespace std;"

Tue Jan 24 04:25:09 GMT 2012  Olly Betts <olly@survex.com>

	* src/findentrances.cc: Give error if required -d option is not
	  specified.

Tue Jan 24 04:19:29 GMT 2012  Olly Betts <olly@survex.com>

	* src/findentrances.cc: Other survex tools use -s for "limit operation
	  to this survey prefix" and just take the .3d file to operate on as
	  a command line argument, so for consistency just take the .3d file
	  as a command line argument here too.

Tue Jan 24 04:18:41 GMT 2012  Olly Betts <olly@survex.com>

	* src/findentrances.cc: Reindent with 4 space indent, tab width 8.

Tue Jan 24 04:12:19 GMT 2012  Olly Betts <olly@survex.com>

	* src/findentrances.cc: Add findentrances utility from Olaf.

Tue Jan 10 12:57:08 GMT 2012  Olly Betts <olly@survex.com>

	* lib/survex.pot,lib/zh_CN.po: Update.

Tue Jan 10 12:56:33 GMT 2012  Olly Betts <olly@survex.com>

	* lib/po_codes: Update locations.

Tue Jan 10 12:55:25 GMT 2012  Olly Betts <olly@survex.com>

	* lib/Makefile.am: When generating survex.pot from po_codes, drop the
	  codes from commented out messages too.

Mon Jan 09 12:21:28 GMT 2012  Olly Betts <olly@survex.com>

	* src/aven.cc: Fix to build with a non-Unicode wxWidgets library.
	  Patch from Olaf Kahler.

Fri Jan 06 11:47:59 GMT 2012  Olly Betts <olly@survex.com>

	* lib/: Touch all the .po files.

Fri Jan 06 11:47:10 GMT 2012  Olly Betts <olly@survex.com>

	* lib/touch-po.pl: New script to "touch" a .po file by updating
	  "PO-Revision-Date:".

Fri Jan 06 11:34:16 GMT 2012  Olly Betts <olly@survex.com>

	* lib/,src/Makefile.am,src/gettexttomsg.pl: Rename codes.po to po_codes
	  so it doesn't get picked up by tools looking for .po files.  Add
	  survex.pot to the repo so launchpad's auto translation syncing can
	  work.

Fri Jan 06 11:25:23 GMT 2012  Olly Betts <olly@survex.com>

	* make_release: Update to use git rather than SVN.

Fri Jan 06 11:19:37 GMT 2012  Olly Betts <olly@survex.com>

	* doc/HACKING.htm: Update mention of "SVN tree" to "source tree" as the
	  files mentioned are shipped in releases too.

Wed Jan 04 05:22:32 GMT 2012  Olly Betts <olly@survex.com>

	* lib/Makefile.am: Make the containing directory in the launchpad
	  tarball “survex-trans”.

Wed Jan 04 03:41:40 GMT 2012  Olly Betts <olly@survex.com>

	* src/dump3d.c: Add support for showing img_ERROR_INFO items.

Tue Jan 03 23:54:26 GMT 2012  Olly Betts <olly@survex.com>

	* lib/fr.po: Incorporate a translation from launchpad I'd previously
	  copied the English version of by mistake.  Attempt to correct
	  mistranslation of "survey file".

Tue Jan 03 13:21:09 GMT 2012  Olly Betts <olly@survex.com>

	* make_release: Need to set VERSION before we first use it!

Tue Jan 03 12:39:38 GMT 2012  Olly Betts <olly@survex.com>

	* NEWS,configure.in: Update for 1.2.5.

Tue Jan 03 12:11:14 GMT 2012  Olly Betts <olly@survex.com>

	* doc/survex.7.in: Make a few minor improvements to the text.

Tue Jan 03 12:07:31 GMT 2012  Olly Betts <olly@survex.com>

	* doc/survex.7.in: Update section in .TH macro to 7 too.

Tue Jan 03 12:04:54 GMT 2012  Olly Betts <olly@survex.com>

	* src/moviemaker.cc: Further fix.

Tue Jan 03 11:05:11 GMT 2012  Olly Betts <olly@survex.com>

	* configure.in,src/moviemaker.cc: Fix to work with newer ffmpeg.

Mon Jan 02 13:10:42 GMT 2012  Olly Betts <olly@survex.com>

	* src/gfxcore.cc: Draw measuring line above indicators rather than
	  underneath them.

Mon Jan 02 12:52:47 GMT 2012  Olly Betts <olly@survex.com>

	* src/message.c: Improve handling of messages before the message
	  subsystem is fully initialised.

Mon Jan 02 12:37:18 GMT 2012  Olly Betts <olly@survex.com>

	* src/Makefile.am,src/mainfrm.cc,src/namecmp.h: Add a version of the
	  station name comparing algorithm which works with the Unicode strings
	  directly, which fixes the issue with random ordering of the prefix
	  tree control in aven due to the converted strings we were comparing 
	  getting invalidated before we actually compared them.

Mon Jan 02 12:12:35 GMT 2012  Olly Betts <olly@survex.com>

	* src/gla-gl.cc: If glGenLists() fails, flag the list as NEVER_CACHE
	  as there's unlikely to be much point calling glGenLists() again.
	* src/gla-gl.cc,src/gla.h: Replace GLAList methods test_flag() and
	  InvalidateList() with an invalidate_if() method.

Mon Jan 02 11:54:38 GMT 2012  Olly Betts <olly@survex.com>

	* src/gfxcore.cc,src/gla-gl.cc: No need to invalidate the display lists
	  for the compass and clino when a new survey is loaded as they don't
	  depend on the survey data.

Mon Jan 02 11:17:51 GMT 2012  Olly Betts <olly@survex.com>

	* src/gla-gl.cc,src/gla.h: Rework list caching code to not call
	  glDeleteLists() and glGenLists() when a list is invalidated, as that
	  results in a fresh list number being allocated (at least with the
	  OpenGL implementation I'm using) which would eventually result in
	  aven hitting an assertion which is there to catch if we leak lists.

Sun Jan 01 13:29:03 GMT 2012  Olly Betts <olly@survex.com>

	* lib/Makefile.am: Put translation files in a sub-directory in the
	  tarball, and print the path to it so it can be cut-and-pasted to
	  upload to launchpad.

Sun Jan 01 10:48:01 GMT 2012  Olly Betts <olly@survex.com>

	* lib/it.po: Add "translation" for degree symbol.

Sun Jan 01 10:33:55 GMT 2012  Olly Betts <olly@survex.com>

	* lib/en_US.po: Merge template changes into en_US.po (no user-visible
	  changes).

Sun Jan 01 04:45:03 GMT 2012  Olly Betts <olly@survex.com>

	* make_release: Fix typo in filename to copy to webserver.  Show the
	  SHA1 checksums for the uploaded files.

Sun Jan 01 02:56:04 GMT 2012  Olly Betts <olly@survex.com>

	* NEWS,configure.in: Update for 1.2.4.

Sun Jan 01 02:53:03 GMT 2012  Olly Betts <olly@survex.com>

	* src/gfxcore.cc,src/gfxcore.h: Update copyright years.

Sun Jan 01 02:32:59 GMT 2012  Olly Betts <olly@survex.com>

	* src/gfxcore.cc,src/gfxcore.h: Improve labelling of depth colour key
	  to avoid sub-picometre precision on near-zero values (ticket#30).
	  We now always use metres or feet for the depth with a consistent
	  precision chosen from the depth range, and show the units below
	  the colour bar rather than after every value.
	* src/gfxcore.cc,src/gfxcore.h: When zooming way in, stay in metres
	  rather than switching to cm.  Say “1 mile” rather than “1 miles”.

Sat Dec 31 22:40:07 GMT 2011  Olly Betts <olly@survex.com>

	* src/gla-gl.cc: Fix not to make OpenGL calls before we've initialised
	  OpenGL, as this can cause segmentation faults (e.g. on Fedora 16).
	  Extend CHECK_GL_ERROR() to check that we don't make such calls in
	  future.

Sat Dec 31 22:37:47 GMT 2011  Olly Betts <olly@survex.com>

	* lib/es.po: Fix "Last-Translator:" header and merge in translation
	  of a message which is not currently used.

Sat Dec 31 15:04:23 GMT 2011  Olly Betts <olly@survex.com>

	* lib/: Merge remaining .po files.

Sat Dec 31 14:46:20 GMT 2011  Olly Betts <olly@survex.com>

	* lib/: Merge more .po files.

Sat Dec 31 14:24:25 GMT 2011  Olly Betts <olly@survex.com>

	* lib/ca.po,lib/de_CH.po,lib/en_US.po: Merge template changes into .po
	  files.

Sat Dec 31 13:13:55 GMT 2011  Olly Betts <olly@survex.com>

	* lib/fr.po: More translation updates from launchpad.

Sat Dec 31 12:51:53 GMT 2011  Olly Betts <olly@survex.com>

	* lib/ca.po,lib/sk.po: Fix unattached acute accents.

Sat Dec 31 12:45:36 GMT 2011  Olly Betts <olly@survex.com>

	* lib/: Update Project-Id-Version in .po files to match that in
	  survex.pot.

Sat Dec 31 12:43:52 GMT 2011  Olly Betts <olly@survex.com>

	* lib/Makefile.am: Add launchpad-tarball target to make a tarball
	  of the translations suitable for uploading to launchpad.

Sat Dec 31 12:23:39 GMT 2011  Olly Betts <olly@survex.com>

	* make_release: Echo the commands to copy the new release to the web
	  server at the end.
	* copy-prerelease,copy-release: Remove old scripts which are no longer
	  useful.

Sat Dec 31 11:13:11 GMT 2011  Olly Betts <olly@survex.com>

	* NEWS,configure.in: Update for 1.2.3.

Sat Dec 31 10:58:34 GMT 2011  Olly Betts <olly@survex.com>

	* src/mainfrm.cc: As we build the data structure, eliminate tubes
	  consisting of zero XSECTs as well as those consisting of just one.

Sat Dec 31 10:36:24 GMT 2011  Olly Betts <olly@survex.com>

	* src/img.h: Fix incorrect comment which claimed that img_XFLAG_END
	  was no longer used.
	* src/img.c: Use img_XFLAG_END constant rather than assuming it is
	  1.

Sat Dec 31 10:32:44 GMT 2011  Olly Betts <olly@survex.com>

	* src/extend.c: Copy the end markers for passage tubes, and preserve
	  left and right data for tubes (previously they were set to -1.0
	  which means "no info").

Sat Dec 31 08:17:08 GMT 2011  Olly Betts <olly@survex.com>

	* lib/extract-msgs.pl: New script to allow developers to update
	  codes.po from source code.
	* lib/Makefile.am: Ship it.
	* src/Makefile.am: Add rule to run it on all used sources and generate
	  newcodes.po which can then be compared with current version.

Sat Dec 31 08:14:06 GMT 2011  Olly Betts <olly@survex.com>

	* lib/codes.po: Update source locations, add a missing c-format marker.

Sat Dec 31 08:13:26 GMT 2011  Olly Betts <olly@survex.com>

	* src/mainfrm.cc: Fix a message in the source code which I missed in
	  the previous batch.

Sat Dec 31 08:12:23 GMT 2011  Olly Betts <olly@survex.com>

	* lib/po-to-msg.pl: Removed unused remains of check that messages are
	  in numerically ascending order, which we no longer want to enforce.

Sat Dec 31 07:48:20 GMT 2011  Olly Betts <olly@survex.com>

	* src/sorterr.c: Fix a message in the source code which I missed in
	  the previous batch.

Sat Dec 31 05:54:45 GMT 2011  Olly Betts <olly@survex.com>

	* src/message.c: Transliterate curly right single quote to ASCII
	  apostrophe if we can't represent it in the current character set.

Sat Dec 31 05:44:47 GMT 2011  Olly Betts <olly@survex.com>

	* lib/,src/: Use curly apostrophe instead of "'" in messages.  Correct
	  messages in source code which didn't match those in the message file
	  (no visible effects to end-users).
	* lib/codes.po: Update file:lineno locations where messages are used.
	* lib/po-to-msg.pl: Warn about different numbers of opening or
	  closing curly double quotes in message vs translation.
	* lib/ca.po,lib/es.po: Fix minor typo in one message caught by this
	  new warning.

Sat Dec 31 05:23:46 GMT 2011  Olly Betts <olly@survex.com>

	* NEWS: Update from ChangeLog.

Thu Dec 29 03:37:04 GMT 2011  Olly Betts <olly@survex.com>

	* lib/,src/: Use curly double quotes instead of "`" and "'" to
	  quote literals and filenames in messages.

Thu Dec 29 03:21:49 GMT 2011  Olly Betts <olly@survex.com>

	* src/message.c: Transliterate curly double quotes to ASCII straight
	  double quotes if we can't represent them in the current character
	  set.

Thu Dec 29 03:14:52 GMT 2011  Olly Betts <olly@survex.com>

	* src/message.c: Convert source code to UTF-8.

Thu Dec 29 00:52:44 GMT 2011  Olly Betts <olly@survex.com>

	* src/gla-gl.cc: Fix typo in CHECK_GL_ERROR() change in previous
	  commit.

Thu Dec 29 00:49:31 GMT 2011  Olly Betts <olly@survex.com>

	* src/gla-gl.cc: We already keep track of the GL canvas size in x_size
	  and y_size so use those rather than re-requesting them.

Wed Dec 28 11:45:40 GMT 2011  Olly Betts <olly@survex.com>

	* lib/fr.po: Merge in updated translations from launchpad.

Sun Nov 27 12:30:31 GMT 2011  Olly Betts <olly@survex.com>

	* src/tr.c,src/tr.h: Committing original versions of tr tiled
	  rendering code.

Thu Nov 24 12:59:24 GMT 2011  Olly Betts <olly@survex.com>

	* src/gfxcore.cc,src/gla-gl.cc,src/gla.h: Remove
	  GLACanvas::SetBackgroundColour() since we only ever set it to black
	  and opaque.

Thu Nov 24 12:28:07 GMT 2011  Olly Betts <olly@survex.com>

	* doc/TODO.htm: Add note to pick the fastest method for crosses/blobs
	  if multiple ones pass the visual fidelity check.

Thu Nov 24 12:27:33 GMT 2011  Olly Betts <olly@survex.com>

	* src/gla-gl.cc: Add disabled code to show the visual fidelity check on
	  stdout.

Thu Nov 24 12:24:49 GMT 2011  Olly Betts <olly@survex.com>

	* src/gla-gl.cc: Fix screenshot and movie generation to read from the
	  front buffer in the usual case of being double buffered.

Thu Nov 24 12:02:22 GMT 2011  Olly Betts <olly@survex.com>

	* src/gla-gl.cc: Add CHECK_GL_ERROR for glReadPixels calls.

Thu Nov 24 11:59:23 GMT 2011  Olly Betts <olly@survex.com>

	* src/gla-gl.cc: Undefine o and I after we're done with them.

Thu Nov 24 11:56:57 GMT 2011  Olly Betts <olly@survex.com>

	* src/gla-gl.cc: Fix expected cross shape so don't always reject using 
	  texture mapping to draw crosses.

Wed Nov 02 15:40:45 GMT 2011  Olly Betts <olly@survex.com>

	* src/mainfrm.cc: Don't create the help menu at all on OS X.

Wed Nov 02 15:38:54 GMT 2011  Olly Betts <olly@survex.com>

	* lib/INSTALL.OSX: Update to reflect current status.

Wed Nov 02 15:37:58 GMT 2011  Olly Betts <olly@survex.com>

	* src/gfxcore.cc: Remove duplicate call to PopupMenu().

Tue Nov 01 23:24:23 GMT 2011  Olly Betts <olly@survex.com>

	* src/namecmp.h: Fix to build with wx 2.9.2.

Tue Nov 01 23:17:52 GMT 2011  Olly Betts <olly@survex.com>

	* src/gfxcore.cc: Remove assertion which uses deprecated wx method.

Tue Nov 01 23:14:09 GMT 2011  Olly Betts <olly@survex.com>

	* src/mainfrm.cc,src/mainfrm.h: Make separator wxChar not int.

Tue Nov 01 18:54:32 GMT 2011  Olly Betts <olly@survex.com>

	* lib/sk.po: Update a translation from launchpad.

Tue Nov 01 18:32:24 GMT 2011  Olly Betts <olly@survex.com>

	* src/log.cc,src/log.h: Fix to build with wx 2.9.2.

Tue Nov 01 18:15:20 GMT 2011  Olly Betts <olly@survex.com>

	* src/export.cc: Fix to build with wx 2.9.2.

Tue Nov 01 18:14:13 GMT 2011  Olly Betts <olly@survex.com>

	* src/aboutdlg.cc: Fix code conditionally used on 2.9.2 and later to
	  actually compile.

Tue Nov 01 18:12:42 GMT 2011  Olly Betts <olly@survex.com>

	* src/gfxcore.cc: Fix how we pass on events from right-click menus of
	  indicators.  The previous code seemed to work, but wasn't correct
	  as highlighted by trying to build it with 2.9.2 which now refuses
	  to build to avoid people getting this wrong.

Tue Nov 01 18:11:55 GMT 2011  Olly Betts <olly@survex.com>

	* src/aven.h: Need to forward declare class wxPageSetupDialogData for
	  wx 2.9.2.

Tue Nov 01 18:11:22 GMT 2011  Olly Betts <olly@survex.com>

	* src/glbitmapfont.h: Fix to build with wx 2.9.2.

Tue Nov 01 18:10:51 GMT 2011  Olly Betts <olly@survex.com>

	* src/cavernlog.cc: Fix to build with wx 2.9.2.

Tue Nov 01 18:06:12 GMT 2011  Olly Betts <olly@survex.com>

	* lib/INSTALL.OSX,src/mainfrm.cc: Make the green colour used for
	  entrances in the survey tree the same (slightly darker than
	  before) green used for the entrance blobs.

Tue Nov 01 18:04:47 GMT 2011  Olly Betts <olly@survex.com>

	* src/gla-gl.cc: Fix warning when building with wx2.9.2.

Tue Nov 01 12:32:30 GMT 2011  Olly Betts <olly@survex.com>

	* src/printwx.cc: Fix Y coordinates of surface surveys on printouts.
	  (Closes #32)

Sun Oct 23 06:20:14 GMT 2011  Olly Betts <olly@survex.com>

	* lib/Info.plist.in: Remove spurious blank lines from licence text
	  in OS X "Get Info".

Sat Oct 22 17:39:07 GMT 2011  Olly Betts <olly@survex.com>

	* doc/TODO.htm: Opening dialogs while in full screen mode now works
	  better in wxGTK.

Sat Oct 22 17:36:01 GMT 2011  Olly Betts <olly@survex.com>

	* lib/INSTALL.OSX: Processing .svx files from aven now works.

Sat Oct 22 07:27:43 GMT 2011  Olly Betts <olly@survex.com>

	* src/printwx.h: Update comment - Mac OS X does indeed provide its own
	  preview menu.

Fri Oct 21 23:47:16 GMT 2011  Olly Betts <olly@survex.com>

	* src/cavernlog.cc: Fix openiof .svx file when user clicks on cavern
	  warning or error.

Fri Oct 21 23:43:21 GMT 2011  Olly Betts <olly@survex.com>

	* buildmacosx.sh: Include a hardlinked cavern alongside aven in
	  the app so that processing .svx files in aven works.

Wed Oct 19 22:51:18 GMT 2011  Olly Betts <olly@survex.com>

	* tests/diving.pos,tests/diving.svx: Add test coverage for interleaved
	  diving data.

Wed Oct 19 13:04:25 GMT 2011  Olly Betts <olly@survex.com>

	* tests/diving.pos,tests/diving.svx: Add testcase for diving data
	  with topofil-style distance.

Wed Oct 12 03:45:13 GMT 2011  Olly Betts <olly@survex.com>

	* src/aboutdlg.cc: Report the version of the library we're actually
	  running with if built against wx >= 2.9.2.  Make it clear that the
	  the version reported is the version built with for wx < 2.9.2.

Wed Oct 12 03:06:05 GMT 2011  Olly Betts <olly@survex.com>

	* lib/make-pixel-font,src/glbitmapfont.cc,src/glbitmapfont.h: Space the
	  glyphs to leave a one pixel gap either side of each one (so two
	  between adjacent glyphs).  Mostly this reduces the horizontal width,
	  but it adds a pixel for characters like "m" and two in a few cases.

Fri Oct 07 07:20:55 GMT 2011  Olly Betts <olly@survex.com>

	* src/glbitmapfont.cc,src/glbitmapfont.h: Support plotting Unicode
	  character points > 256 on the survey pane by lazily loading the
	  data for them from the font file and plotting them with a direct
	  call to glBitmap() rather than using a display list.

Fri Oct 07 04:09:58 GMT 2011  Olly Betts <olly@survex.com>

	* lib/make-pixel-font: Fix .pixelfont file to correctly handle
	  characters wider than 8 pixels when run on a little-endian platform.

Thu Oct 06 13:23:05 GMT 2011  Olly Betts <olly@survex.com>

	* NEWS: Another update for 1.2.2.

Thu Oct 06 13:21:20 GMT 2011  Olly Betts <olly@survex.com>

	* src/gfxcore.cc: Fix grid not to disappear when blobs are turned on
	  if blobs are drawn using lines.

Thu Oct 06 13:17:19 GMT 2011  Olly Betts <olly@survex.com>

	* NEWS,configure.in: Update for 1.2.2.

Thu Oct 06 12:11:20 GMT 2011  Olly Betts <olly@survex.com>

	* src/printwx.cc: Fix to calculate the scale required for "One page"
	  right before we calculate how many pages are required, so we don't
	  end up something other than 1x1 being shown when the user changes
	  settings.

Thu Oct 06 12:07:10 GMT 2011  Olly Betts <olly@survex.com>

	* src/avenprcore.cc: The info box is now always 30mm high (if present)
	  so update the code which picks a scale and which decides how many
	  pages are required to use this height.

Thu Oct 06 11:34:51 GMT 2011  Olly Betts <olly@survex.com>

	* src/printwx.h: SomethingChanged() method doesn't need to be public,
	  so make it private.

Thu Oct 06 04:13:24 GMT 2011  Olly Betts <olly@survex.com>

	* src/gettexttomsg.pl: Update for the message.txt -> codes.po change.

Thu Oct 06 03:01:45 GMT 2011  Olly Betts <olly@survex.com>

	* src/gfxcore.cc: Passage tubes can stick out above the highest survey
	  station or below the lowest, so clamp the value used to calculate
	  the colour in these cases, like we already do elsewhere.

Thu Oct 06 02:52:13 GMT 2011  Olly Betts <olly@survex.com>

	* src/gfxcore.cc: Avoid a different assertion failure due to rounding
	  differences.

Thu Oct 06 02:49:03 GMT 2011  Olly Betts <olly@survex.com>

	* src/glbitmapfont.cc,src/glbitmapfont.h: Actually add the new
	  glBitmap-based font code.

Thu Oct 06 02:36:47 GMT 2011  Olly Betts <olly@survex.com>

	* survex.iss.in: Update for font changes.

Thu Oct 06 02:35:41 GMT 2011  Olly Betts <olly@survex.com>

	* Makefile.am,buildmacosx.sh,lib/Makefile.am,lib/afm2txf.pl,
	  lib/make-pixel-font,src/: Replace the textured-mapped font drawing
	  with an approach based on glBitmap.  This doesn't suffer from the
	  character alignment issues which the textured-mapped fonts had,
	  and is actually significantly faster on some machines.  The current
	  font used is (mostly) fixed-width, but this isn't an inherent
	  limitation - it was just the easiest font data to convert to a
	  usable format.

Wed Oct 05 13:49:15 GMT 2011  Olly Betts <olly@survex.com>

	* src/gfxcore.cc: Avoid assertion failure due to rounding differences.

Wed Oct 05 08:19:46 GMT 2011  Olly Betts <olly@survex.com>

	* src/printwx.cc: Fix not to pass wxString through varargs (issue
	  introduced in the previous commit).

Tue Oct 04 04:49:19 GMT 2011  Olly Betts <olly@survex.com>

	* src/printwx.cc: Use degree sign from message file rather than a
	  literal one.

Tue Oct 04 04:08:57 GMT 2011  Olly Betts <olly@survex.com>

	* src/message.c: If degree sign isn't available, transliterate it to
	  'dg' rather than skipping it.

Tue Oct 04 03:59:29 GMT 2011  Olly Betts <olly@survex.com>

	* lib/codes.po,src/gfxcore.cc,src/mainfrm.cc: Fix message code 344
	  which should have been a degree sign but got lost in the format
	  change for 1.2.0 and then got reassigned in 1.2.1.  Externally, this
	  means that bearing in the status bar now have a degree sign after
	  them if they are in degrees rather than nothing (1.2.0) or "&Hide
	  Compass" (1.2.1).

Tue Oct 04 02:55:11 GMT 2011  Olly Betts <olly@survex.com>

	* NEWS,configure.in: Update for 1.2.1.

Tue Oct 04 02:45:47 GMT 2011  Olly Betts <olly@survex.com>

	* src/Makefile.am: Don't ship the removed hand_mask.xpm.

Tue Oct 04 02:44:37 GMT 2011  Olly Betts <olly@survex.com>

	* src/gfxcore.cc: Sort out inverted cursor mask on __WXMSW__.
	* src/hand.xbm: Invert the dragging hand cursor black vs white so it
	  better matches the other cursors.

Mon Oct 03 23:42:00 GMT 2011  Olly Betts <olly@survex.com>

	* src/printwx.cc: Add back svxPrintout methods GetPageInfo() and
	  HasPage() which are actually virtual methods called by the parent
	  class.

Mon Oct 03 02:40:56 GMT 2011  Olly Betts <olly@survex.com>

	* lib/Makefile.am: Fix check of .po files not to create messages.mo.

Mon Oct 03 02:22:55 GMT 2011  Olly Betts <olly@survex.com>

	* lib/Makefile.am: Fix new translation checking rules to work in a
	  VPATH build.

Mon Oct 03 02:12:23 GMT 2011  Olly Betts <olly@survex.com>

	* lib/de.po,lib/de_CH.po,lib/sk.po: Fix classes menu accelerators.

Mon Oct 03 02:00:38 GMT 2011  Olly Betts <olly@survex.com>

	* lib/en_US.po: Fix problem with translation of new message.

Mon Oct 03 00:50:52 GMT 2011  Olly Betts <olly@survex.com>

	* NEWS: Update from ChangeLog.

Sun Oct 02 20:25:01 GMT 2011  Olly Betts <olly@survex.com>

	* lib/,src/printwx.cc: Add mnemonics to the "Plan" and "Elevation"
	  buttons in the print dialog.

Sun Oct 02 12:17:34 GMT 2011  Olly Betts <olly@survex.com>

	* src/guicontrol.cc: Try processing F11 explicitly for __WXMAC__ to
	  avoiding getting stuck in full screen mode forever.

Sun Oct 02 12:01:25 GMT 2011  Olly Betts <olly@survex.com>

	* src/: Make the sign of the tilt angle for printouts consistent with
	  the sign in the UI.

Sun Oct 02 10:00:08 GMT 2011  Olly Betts <olly@survex.com>

	* lib/codes.po,lib/en_US.po,src/printwx.cc: On printouts, combine the
	  "Plan View"/"Elevation" info box field with the field which gives
	  the bearing and reduce the height on the info box by the removed
	  field, so it's now 3cm for plans and elevations, as for extended
	  elevations.  Report the tilt angle for tilted elevations which it
	  seems has been missing for ages (it's not in recent 1.0.x either).

Sat Oct 01 12:28:35 GMT 2011  Olly Betts <olly@survex.com>

	* src/printwx.cc: Fix commented message in source.

Sat Oct 01 12:11:37 GMT 2011  Olly Betts <olly@survex.com>

	* src/printwx.h: svxPrintDlg members don't need to be protected, so
	  make the private.

Sat Oct 01 11:28:34 GMT 2011  Olly Betts <olly@survex.com>

	* src/printwx.cc,src/printwx.h: When in plan view disable the "Plan"
	  button, and similarly for the "Elevation" button.

Sat Oct 01 11:20:03 GMT 2011  Olly Betts <olly@survex.com>

	* src/printwx.cc: Remove more unused methods and members.

Sat Oct 01 10:48:24 GMT 2011  Olly Betts <olly@survex.com>

	* src/avenprcore.cc,src/printwx.cc,src/printwx.h: Eliminate some unused
	  methods and member variables.

Sat Oct 01 00:33:24 GMT 2011  Olly Betts <olly@survex.com>

	* src/printwx.cc: Move the footer to start at the left side of the
	  page.

Fri Sep 30 23:49:24 GMT 2011  Olly Betts <olly@survex.com>

	* src/printwx.cc:svxPrintout::ShowPage() is an empty method, so just
	  remove it and all the code to calculate values to pass to it and
	  then call it.  This is just a left-over from the 1.0 printing code.

Fri Sep 30 13:40:29 GMT 2011  Olly Betts <olly@survex.com>

	* src/aven.cc,src/gfxcore.cc,src/mainfrm.cc: Use standard C++ true and
	  false instead of wx aliases TRUE and FALSE (which even wx seems to
	  have shifted away from using now).

Fri Sep 30 13:33:37 GMT 2011  Olly Betts <olly@survex.com>

	* src/printwx.cc: Tweak exact positioning of text to look nicer.

Fri Sep 30 03:49:16 GMT 2011  Olly Betts <olly@survex.com>

	* INSTALL: Mention building wxWidgets with --enable-unicode.  Mention
	  using sudo for the install.  Capitalise Survex when talking about
	  the package.
	+ doc/manual.sgml: Replace building from source instructions with a
	  pointer to the clearer instructions in INSTALL.  Make it clear that
	  installing with administrator rights applies to NT, 2000, XP *or
	  newer*.

Fri Sep 30 03:31:00 GMT 2011  Olly Betts <olly@survex.com>

	* src/guicontrol.cc: Don't disable a colour by option unless there's
	  no survey loaded.  It feels inconsistent now we are showing a key
	  even when there's no "interesting" data.

Fri Sep 30 03:28:59 GMT 2011  Olly Betts <olly@survex.com>

	* src/gfxcore.cc,src/gfxcore.h: The different colour keys get cached
	  so switching back to one that's already been shown for the current
	  survey doesn't redraw it and key_lowerleft wasn't getting updated.
	  We now track key_lowerleft for each key type separately.

Fri Sep 30 02:48:00 GMT 2011  Olly Betts <olly@survex.com>

	* src/gfxcore.cc: If "Colour by X" is selected, always show the colour
	  key, even if it only contains one colour, or just the entry for
	  white.

Thu Sep 29 22:33:06 GMT 2011  Olly Betts <olly@survex.com>

	* src/gfxcore.cc: Don't segfault on a flat survey.  Fix incorrect
	  addition and corresponding subtraction of GetDepthExtent() when
	  calculating splits over depth band boundaries.

Thu Sep 29 21:56:19 GMT 2011  Olly Betts <olly@survex.com>

	* src/gfxcore.cc,src/gla.h: Fix zoom in limit to be the same distance
	  regardless of the extent of the survey.

Thu Sep 29 20:57:41 GMT 2011  Olly Betts <olly@survex.com>

	* src/gfxcore.cc: Now that we don't have the key background, just
	  remove KEY_MARGIN entirely.

Thu Sep 29 20:37:09 GMT 2011  Olly Betts <olly@survex.com>

	* src/gfxcore.cc: Remove the dark grey background from the colour key
	  and just put a single pixel black border around the colours.  This
	  is more in keeping with the other controls, and means the colours
	  are now on a black background so more visually similar to the survey
	  legs.

Thu Sep 29 13:02:22 GMT 2011  Olly Betts <olly@survex.com>

	* src/mainfrm.cc: Fall back to ISO8859-1 if CP1252 fails to convert the
	  string.

Thu Sep 29 12:22:34 GMT 2011  Olly Betts <olly@survex.com>

	* src/gfxcore.cc: Upon loading a survey which lacks the information for
	  the current "Colour by" mode, don't change to "Colour by none" - we
	  already do no colouring and hide the key when there's nothing to
	  colour by, and it's annoying to have the actual mode changed if you
	  then load a survey which does have the information to colour by.

Thu Sep 29 12:20:07 GMT 2011  Olly Betts <olly@survex.com>

	* src/gfxcore.cc: Rename COLOUR_KEY_* constants to KEY_*.

Thu Sep 29 10:16:30 GMT 2011  Olly Betts <olly@survex.com>

	* src/gfxcore.cc: Make COLOUR_KEY_OFFSET_X and COLOUR_KEY_OFFSET_Y the
	  actual offsets, rather than taking COLOUR_KEY_MARGIN off them.

Thu Sep 29 05:08:20 GMT 2011  Olly Betts <olly@survex.com>

	* src/mainfrm.cc: Fix tooltip for open to say "survey file" not "3D
	  file".

Thu Sep 29 05:03:37 GMT 2011  Olly Betts <olly@survex.com>

	* src/gfxcore.cc,src/gfxcore.h,src/mainfrm.cc: Add right click menu to
	  the colour key too.

Wed Sep 28 14:47:15 GMT 2011  Olly Betts <olly@survex.com>

	* lib/afm2txf.pl: Add a kludge to prefer to round values up when
	  generating the .txf file which empirically results in better
	  horizontal spacing (this should be fixed properly, but this is
	  at least an easy improvement for now).

Wed Sep 28 14:00:14 GMT 2011  Olly Betts <olly@survex.com>

	* lib/afm2txf.pl: Rather than special-casing the character with
	  PostScript name 'space', just omit characters with zero width and
	  height from the texture.

Wed Sep 28 12:41:42 GMT 2011  Olly Betts <olly@survex.com>

	* lib/afm2txf.pl: Put the digits first in the font texture to help
	  ensure they are all on the same line and will exactly align
	  vertically when rendered - a slight discrepancy here is particularly
	  visible in the colour key legends and compass bearing.

Wed Sep 28 12:30:03 GMT 2011  Olly Betts <olly@survex.com>

	* lib/Makefile.am: Regenerate aven.txf if the script which generates it
	  has been modified.

Wed Sep 28 11:15:08 GMT 2011  Olly Betts <olly@survex.com>

	* lib/afm2txf.pl: Fix handling of PostScript character names which are
	  used by more than one Unicode value ("space" and "hyphen" are the
	  current examples).  This fixes the colour key for date to have dashes
	  in the dates.  Fix not to bother writing empty space into the texture
	  map for spaces - just set width and height to 0 and skip to the
	  width.
	* src/fnt.cc: Remove special case kludge for if space isn't defined,
	  which is no longer needed thanks to the above fix.

Wed Sep 28 10:19:07 GMT 2011  Olly Betts <olly@survex.com>

	* lib/,src/printwx.cc: Fix mixed up messages - the print dialog now
	  says "View" on the left subgroup of controls. Improve the display of
	  the bearing on printouts.  Add message for "Colour &Key" to
	  translations.

Wed Sep 28 02:02:09 GMT 2011  Olly Betts <olly@survex.com>

	* src/aven.cc: Fix #ifdef to #if in previous change.

Wed Sep 28 01:09:09 GMT 2011  Olly Betts <olly@survex.com>

	* src/aven.cc: Fix for non-Unicode build.

Mon Sep 26 12:25:59 GMT 2011  Olly Betts <olly@survex.com>

	* src/export.cc: PLT file output now handles spaces and control
	  characters in station names by escaping them with '%' as in URLs.

Mon Sep 26 11:58:05 GMT 2011  Olly Betts <olly@survex.com>

	* src/aventreectrl.cc: Improve comment about WXK_PRIOR and WXK_NEXT.

Mon Sep 26 11:51:01 GMT 2011  Olly Betts <olly@survex.com>

	* src/aventreectrl.cc: Pressing "Enter" on a station in the tree
	  control now centres the view on that station.

Mon Sep 26 11:42:17 GMT 2011  Olly Betts <olly@survex.com>

	* src/gfxcore.h,src/guicontrol.cc: Pressing "F5" forces all GLAList
	  objects to be invalidated and then forces a refresh of the display.
	  This is intended as a debugging aid - if pressing F5 changes the
	  display at all then there's a missing case where a list should
	  have been invalidated.

Mon Sep 26 11:35:29 GMT 2011  Olly Betts <olly@survex.com>

	* src/: Push survey pane size tracking down into GLACanvas, and
	  automatically track which lists should be invalidated on a
	  changes in the width or the height of the pane.

Mon Sep 26 10:44:22 GMT 2011  Olly Betts <olly@survex.com>

	* src/gla-gl.cc,src/gla.h: Move GLAList flags out of the header as they
	  are internal details.

Mon Sep 26 10:42:50 GMT 2011  Olly Betts <olly@survex.com>

	* src/gfxcore.cc,src/gfxcore.h: Cache the scale bar in a GLAList since
	  it often gets redrawn exactly the same - for example, when rotating,
	  panning, etc.

Mon Sep 26 09:40:32 GMT 2011  Olly Betts <olly@survex.com>

	* src/gfxcore.cc,src/gfxcore.h: More "colour key" related internal
	  nomenclature changes.

Mon Sep 26 09:34:01 GMT 2011  Olly Betts <olly@survex.com>

	* src/gfxcore.cc,src/gfxcore.h: Factor out the code to draw the colour
	  key into DrawColourKey().

Mon Sep 26 04:23:10 GMT 2011  Olly Betts <olly@survex.com>

	* src/gfxcore.cc: Apply COLOUR_KEY_OFFSET_Y by moving the point where
	  we plot the key rather than including it in the calculations of the
	  key's coordinates.

Mon Sep 26 04:17:16 GMT 2011  Olly Betts <olly@survex.com>

	* src/gfxcore.cc: Apply COLOUR_KEY_OFFSET_X by moving the point where
	  we plot the key rather than including it in the calculations of the
	  key's coordinates.

Sat Sep 24 13:15:22 GMT 2011  Olly Betts <olly@survex.com>

	* src/gfxcore.cc: Increase scale bar maximum width from 65% of the
	  window width to 75% as it was in 1.0.x, but if that would overlap
	  the clino then reduce it down until it reaches 50%.  Allow zooming
	  in a little further to match what was possible in 1.0.x.  (ticket#23)

Sat Sep 24 12:45:04 GMT 2011  Olly Betts <olly@survex.com>

	* doc/TODO.htm: Update (--help messages can now be translated).

Sat Sep 24 12:21:45 GMT 2011  Olly Betts <olly@survex.com>

	* doc/TODO.htm: Note oddity with FullScreen and side panel.

Sat Sep 24 12:14:52 GMT 2011  Olly Betts <olly@survex.com>

	* src/mainfrm.h: We don't need the "un-fullscreen to show dialog" hack
	  with recent wxGTK.  Also, there's no reason to think we need it for
	  other platforms (it was enabled everywhere except Microsoft Windows
	  before).

Sat Sep 24 10:42:29 GMT 2011  Olly Betts <olly@survex.com>

	* src/printwx.cc: "delete foo;" not "delete(foo);"

Sat Sep 24 10:41:00 GMT 2011  Olly Betts <olly@survex.com>

	* src/aven.cc,src/gfxcore.cc: No point checking for NULL before calling
	  delete.

Sat Sep 24 10:18:22 GMT 2011  Olly Betts <olly@survex.com>

	* src/: Remove empty destructors.

Sat Sep 24 06:43:33 GMT 2011  Olly Betts <olly@survex.com>

	* doc/TODO.htm,src/gfxcore.cc,src/gla-gl.cc,src/gla.h: Eliminate the
	  last few OpenGL calls from gfxcore.cc.

Sat Sep 24 06:32:02 GMT 2011  Olly Betts <olly@survex.com>

	* src/gfxcore.cc,src/gla-gl.cc,src/gla.h: New type GLATexCoord to avoid
	  using GLint outside of the OpenGL-specific code.

Sat Sep 24 06:08:13 GMT 2011  Olly Betts <olly@survex.com>

	* src/: Move glTexCoord2i() calls out of gfxcore.cc and into gla-gl.cc.
	  Use BeginQuadrilaterals() rather than BeginPolygon() when the shape
	  will definitely have 4 sides.
	  
Sat Sep 24 02:09:48 GMT 2011  Olly Betts <olly@survex.com>

	* src/gfxcore.h,src/guicontrol.cc: Disable "View North" when we're
	  already viewing North, and similarly for other compass points.

Sat Sep 24 01:57:06 GMT 2011  Olly Betts <olly@survex.com>

	* doc/TODO.htm: Update.

Fri Sep 23 15:38:36 GMT 2011  Olly Betts <olly@survex.com>

	* doc/aven.sgml,lib/codes.po,src/: Rename the "depth bar" to "colour
	  key", which better describes it now that it might show dates or
	  errors.

Fri Sep 23 15:19:33 GMT 2011  Olly Betts <olly@survex.com>

	* src/gfxcore.cc,src/gfxcore.h,src/guicontrol.cc: Fix the conditions
	  under which colour by date can be enabled to fully match what we
	  now intend.

Fri Sep 23 15:04:35 GMT 2011  Olly Betts <olly@survex.com>

	* src/gfxcore.cc,src/mainfrm.cc: Enable "colour by date" if there are
	  any surveys with date information.  Move the "Undated" / "Not in
	  loop" entry down a little to improve the appearance.  Make each
	  entry in the colour keys a pixel taller so it's an even number of
	  pixels and will divide by two exactly.

Fri Sep 23 14:59:33 GMT 2011  Olly Betts <olly@survex.com>

	* src/fnt.cc: Remove "*1.25" fudge factor from font size for texture
	  mapped fonts.

Fri Sep 23 12:44:18 GMT 2011  Olly Betts <olly@survex.com>

	* lib/en_US.po: Update for new messages.

Fri Sep 23 12:41:16 GMT 2011  Olly Betts <olly@survex.com>

	* src/gfxcore.cc: Expand context menu for compass to include "View
	  North", etc;  Similarly add "Plan" and "Elevation" to clino context
	  menu.

Fri Sep 23 12:25:10 GMT 2011  Olly Betts <olly@survex.com>

	* src/gla-gl.cc: Use += to make code clearer.

Fri Sep 23 12:16:36 GMT 2011  Olly Betts <olly@survex.com>

	* lib/codes.po,src/gfxcore.cc,src/gfxcore.h,src/guicontrol.cc: Add
	  pop-up menus for right clicks on scale bar, compass, and clino.

Fri Sep 23 11:17:31 GMT 2011  Olly Betts <olly@survex.com>

	* src/gfxcore.cc: Use HasRangeOfDates() consistently.

Thu Sep 22 23:56:06 GMT 2011  Olly Betts <olly@survex.com>

	* src/gla-gl.cc: Add missing newline to OpenGL info when GLX info isn't
	  reported.

Thu Sep 22 13:51:55 GMT 2011  Olly Betts <olly@survex.com>

	* survex.spec.in: Man pages are no longer installed in /usr/man so
	  no need to move them from there.  Package aven.svg.  Package
	  files for vim support.  (Fixes from James Begley)

Thu Sep 22 12:45:58 GMT 2011  Olly Betts <olly@survex.com>

	* lib/: Updates from launchpad.

Thu Sep 22 07:12:22 GMT 2011  Olly Betts <olly@survex.com>

	* lib/: Update .po files from template.

Thu Sep 22 07:12:01 GMT 2011  Olly Betts <olly@survex.com>

	* lib/codes.po: Improvements to "TRANSLATORS" comments.

Thu Sep 22 02:47:33 GMT 2011  Olly Betts <olly@survex.com>

	* lib/Makefile.am: Add check that numeric codes haven't escaped into
	  the translated .po files.

Wed Sep 21 14:38:16 GMT 2011  Olly Betts <olly@survex.com>

	* lib/es.po: Update with new msgids.

Wed Sep 21 14:37:53 GMT 2011  Olly Betts <olly@survex.com>

	* lib/en_US.po: Fix typo (doubled ").

Wed Sep 21 14:37:14 GMT 2011  Olly Betts <olly@survex.com>

	* lib/Makefile.am: Check format of .po files with msgfmt -c
	  --check-accelerators.

Wed Sep 21 13:49:05 GMT 2011  Olly Betts <olly@survex.com>

	* lib/en_US.po: Update en_US translation.

Wed Sep 21 13:47:36 GMT 2011  Olly Betts <olly@survex.com>

	* lib/codes.po,src/cad3d.c: Tweak wording of a message.  Remove
	  "unused" messages which have actually just been adapted slightly,
	  add back a removed unused message, and mark an unused message as
	  unused.
`
Wed Sep 21 13:20:58 GMT 2011  Olly Betts <olly@survex.com>

	* lib/codes.po,src/mainfrm.cc: Make more messages translatable.

Wed Sep 21 12:53:02 GMT 2011  Olly Betts <olly@survex.com>

	* lib/codes.po,src/: cmdline_set_syntax_message() now takes message
	  numbers, plus an optional string argument.

Wed Sep 21 12:17:19 GMT 2011  Olly Betts <olly@survex.com>

	* src/mainfrm.cc: Fix to set the correct filename on the root of the
	  survey tree.

Wed Sep 21 11:25:53 GMT 2011  Olly Betts <olly@survex.com>

	* lib/codes.po,src/log.cc,src/mainfrm.cc,src/printwx.cc: Make more
	  messages translatable.

Wed Sep 21 07:30:28 GMT 2011  Olly Betts <olly@survex.com>

	* lib/codes.po,src/dump3d.c,src/gfxcore.cc,src/mainfrm.cc: Make more
	  messages translatable.  In the colour key for "colour by date",
	  change "No info" to "Undated".

Wed Sep 21 04:20:52 GMT 2011  Olly Betts <olly@survex.com>

	* lib/codes.po,src/cavernlog.cc: Allow the "Reprocess" button label in
	  aven's cavern log window to be translated.

Wed Sep 21 04:07:29 GMT 2011  Olly Betts <olly@survex.com>

	* lib/,src/: Extract all the help strings in --help output and make
	  them available for translation.

Wed Sep 21 04:04:31 GMT 2011  Olly Betts <olly@survex.com>

	* lib/Makefile.am: Check there are no duplicate message codes in
	  codes.po as part of "make check".

Wed Sep 21 02:29:21 GMT 2011  Olly Betts <olly@survex.com>

	* src/gfxcore.cc,src/gla-gl.cc,src/gla.h: Eliminate glReadPixels() call
	  from src/gfxcore.cc.

Wed Sep 21 02:28:21 GMT 2011  Olly Betts <olly@survex.com>

	* lib/codes.po,lib/en_US.po,src/aboutdlg.cc: Make all strings in
	  src/aboutdlg.cc translatable.

Wed Sep 21 01:56:15 GMT 2011  Olly Betts <olly@survex.com>

	* doc/manual.sgml: Tweak text about Debian packages.

Tue Sep 20 11:31:03 GMT 2011  Olly Betts <olly@survex.com>

	* tests/: Update FSF address.

Tue Sep 20 11:28:50 GMT 2011  Olly Betts <olly@survex.com>

	* lib/print.ini: Update reference to Survex 1.1; update FSF address.

Tue Sep 20 06:43:56 GMT 2011  Olly Betts <olly@survex.com>

	* src/img.c: Only define INT32_T if it isn't already defined (it will
	  be for 1.0.x).

Tue Sep 20 06:43:23 GMT 2011  Olly Betts <olly@survex.com>

	* src/cavern.c: Remove unused function left over from recent change to
	  how coordinate ranges get reported.

Tue Sep 20 06:42:31 GMT 2011  Olly Betts <olly@survex.com>

	* make_release: Use the URL field from svn info in the command we give
	  to take this release rather than hard-coding the URL for trunk.

Tue Sep 20 05:43:11 GMT 2011  Olly Betts <olly@survex.com>

	* buildmacosx.sh: Building on 10.6 should work on 10.7, so update
	  comment to more clearly reflect that.

Tue Sep 20 05:39:50 GMT 2011  Olly Betts <olly@survex.com>

	* lib/,src/cavern.c: Fix reporting of ranges of survey coordinates,
	  which was broken by the message handling changes in 1.2.0.

Tue Sep 20 04:30:14 GMT 2011  Olly Betts <olly@survex.com>

	* configure.in,src/moviemaker.cc: Fix to build with FFmpeg library
	  versions in Debian unstable, as well as those in Debian stable.

Tue Sep 20 03:51:40 GMT 2011  Olly Betts <olly@survex.com>

	* src/moviemaker.cc: Updates towards compatibility with newer FFmpeg
	  libraries without breaking build with those in Debian stable.

Tue Sep 20 03:41:58 GMT 2011  Olly Betts <olly@survex.com>

	* src/avenprcore.h: Declare border as "struct border" rather than as a
	  typedef to avoid a -Wshadow warning.

Tue Sep 20 00:15:07 GMT 2011  Olly Betts <olly@survex.com>

	* NEWS: Perhaps the final update for 1.2.0.

Tue Sep 20 00:09:42 GMT 2011  Olly Betts <olly@survex.com>

	* lib/afm2txf.pl: Fix to correctly handle non-ASCII glyphs by using
	  glyphshow in the generated PostScript code rather than relying on the
	  numeric encoding order of the font to match Unicode (which doesn't
	  generally seem to be the case).  Tweak to process files without
	  slurping them all into memory where that's easy to do.

Mon Sep 19 23:15:46 GMT 2011  Olly Betts <olly@survex.com>

	* src/fnt.cc: Use FNT_MAXCHAR instead of literal 256.

Mon Sep 19 21:58:50 GMT 2011  Olly Betts <olly@survex.com>

	* buildmacosx.sh: Revert CPP=cpp change - it's not required.  Revert to
	  using wx 2.8.11 and 2.8.12 seems to fail to build.  Output of hdid
	  can contain spaces as well as tabs (man page only documents tabs) so
	  update regexps to take this into account.

Mon Sep 19 11:52:50 GMT 2011  Olly Betts <olly@survex.com>

	* buildmacosx.sh: Add comment noting that Xcode is probably required.
	  Since wxWidgets only supports building for a single arch at a time,
	  build for i386 by default, which should also work on x86_64.  Pass
	  CPP=cpp to wxWidgets configure (not certain if this is actually
	  needed, or was something tried on the way to discovering that only
	  one -arch option can be passed).

Sun Sep 18 12:24:41 GMT 2011  Olly Betts <olly@survex.com>

	* make_release: No need to force disabling of libavcodec for mingw - it
	  gets automatically disable if not present.

Sun Sep 18 12:23:39 GMT 2011  Olly Betts <olly@survex.com>

	* src/moviemaker.cc: Fix disabling of libavcodec-using code when
	  libavcodec isn't present.

Sun Sep 18 11:50:06 GMT 2011  Olly Betts <olly@survex.com>

	* NEWS: Update 1.2.0 release date.

Sun Sep 18 11:49:46 GMT 2011  Olly Betts <olly@survex.com>

	* make_release: Disable use of libavcodec for mingw for now.

Sun Sep 18 02:51:52 GMT 2011  Olly Betts <olly@survex.com>

	* make_release: Fix comment typo.

Sun Sep 18 02:50:30 GMT 2011  Olly Betts <olly@survex.com>

	* doc/TODO.htm: Update in preparation for releasing 1.2.

Sun Sep 18 02:49:53 GMT 2011  Olly Betts <olly@survex.com>

	* src/gla-gl.cc: Only try to read the GLX version on platforms which
	  use GLX.

Sun Sep 18 02:03:13 GMT 2011  Olly Betts <olly@survex.com>

	* Makefile.am,doc/Makefile.am: Don't list other .in files explicitly in
	  EXTRA_DIST.

Sun Sep 18 01:59:49 GMT 2011  Olly Betts <olly@survex.com>

	* lib/Makefile.am: survex.keys.in will get shipped because it is
	  used by AC_CONFIG_FILES so there's no need to list it explicitly
	  in EXTRA_DIST.

Sun Sep 18 01:56:18 GMT 2011  Olly Betts <olly@survex.com>

	* configure.in,lib/Makefile.am,lib/po-to-msg.pl: Fix .msg file
	  generation to work when srcdir != builddir.  Drop the "dontextract"
	  mechanism which automatically generates headers to allows building a
	  version with translations for the messages for errors in loading the
	  messages file, as it doesn't seem worth the effort to get it working
	  again.  It's easy to write such a header by hand if you really want
	  to do this.

Fri Sep 16 14:26:43 GMT 2011  Olly Betts <olly@survex.com>

	* NEWS,configure.in: Update for 1.2.0.

Fri Sep 16 14:22:20 GMT 2011  Olly Betts <olly@survex.com>

	* lib/icons/Makefile.am,lib/icons/aven.png,lib/icons/aven.svg: Add
	  new version of aven icon, redrawn in SVG so it displays nicely at
	  larger sizes.

Fri Sep 16 12:55:05 GMT 2011  Olly Betts <olly@survex.com>

	* lib/codes.po,src/cavern.c: Add --3d-version option to allow the user
	  to specify the version of the 3d format to output.  (ticket#21)

Fri Sep 16 12:52:55 GMT 2011  Olly Betts <olly@survex.com>

	* src/img.c,src/img.h: Make the highest and lowest valid values for
	  img_output_version available in img.h as IMG_VERSION_MIN and
	  IMG_VERSION_MAX.

Fri Sep 16 05:49:12 GMT 2011  Olly Betts <olly@survex.com>

	* src/aventreectrl.cc,src/guicontrol.cc,src/mainfrm.cc: Don't use
	  deprecated members or methods of wxKeyEvent.

Fri Sep 16 03:36:54 GMT 2011  Olly Betts <olly@survex.com>

	* lib/map.png: Remove scan of map which isn't used and we probably
	  don't have rights to redistribute.

Fri Sep 16 03:16:01 GMT 2011  Olly Betts <olly@survex.com>

	* src/mainfrm.cc: If a label isn't valid UTF-8, treat it as CP1252 (the
	  Microsoft superset of ISO8859-1).

Fri Sep 16 03:00:51 GMT 2011  Olly Betts <olly@survex.com>

	* src/mainfrm.cc: Remove special handling for toggling "full screen"
	  on wxGTK as it's no longer required with modern versions.

Fri Sep 16 02:05:12 GMT 2011  Olly Betts <olly@survex.com>

	* src/gfxcore.cc,src/gfxcore.h,src/mainfrm.cc: Don't redraw the survey
	  on every mouse movement in the survey pane unless the measuring line
	  is (or just was) active.  (ticket #17)

Thu Sep 15 03:58:59 GMT 2011  Olly Betts <olly@survex.com>

	* src/aven.cc: Comment improvements.

Thu Sep 15 03:51:27 GMT 2011  Olly Betts <olly@survex.com>

	* tests/smoke.tst: aven no longer requires an X display for --help or
	  --version, so replace skip of this check with a check that this
	  remains the case.

Thu Sep 15 02:27:57 GMT 2011  Olly Betts <olly@survex.com>

	* NEWS: Update from ChangeLog.

Thu Sep 15 02:11:28 GMT 2011  Olly Betts <olly@survex.com>

	* lib/Makefile.am: Distribute codes.po.

Thu Sep 15 02:08:35 GMT 2011  Olly Betts <olly@survex.com>

	* configure.in,survex.spec.in: Default to installing docs into
	  /usr/share/doc/survex rather than /usr/doc/survex.

Wed Sep 14 01:57:45 GMT 2011  Olly Betts <olly@survex.com>

	* src/mainfrm.cc: Fix another potential read beyond the end of a
	  string.

Wed Sep 14 01:35:20 GMT 2011  Olly Betts <olly@survex.com>

	* src/mainfrm.cc: Fix potential reading off end of string - fix from
	  Stuart Bennett.

Wed Sep 14 00:33:16 GMT 2011  Olly Betts <olly@survex.com>

	* lib/es.po: Update from launchpad.

Tue Sep 13 22:05:59 GMT 2011  Olly Betts <olly@survex.com>

	* buildmacosx.sh: Use wx 2.8.12.

Tue Sep 13 11:32:18 GMT 2011  Olly Betts <olly@survex.com>

	* src/aven.cc,src/aven.h,src/gla-gl.cc: Explicitly request
	  double-buffering, which seems to be needed for systems with GLX >=
	  1.3.  Report GLX version and whether double-buffering is in use in
	  the about dialog.

Sun Jun 19 11:19:51 GMT 2011  Olly Betts <olly@survex.com>

	* src/: Try to report errors from generating movie more helpfully.

Fri Jun 17 06:33:38 GMT 2011  Olly Betts <olly@survex.com>

	* src/moviemaker.cc: Eliminate use of deprecated function
	  av_alloc_format_context().

Fri Jun 17 06:32:50 GMT 2011  Olly Betts <olly@survex.com>

	* src/moviemaker.cc: Simplify the loop to flip the image vertically.

Fri Jun 17 06:17:20 GMT 2011  Olly Betts <olly@survex.com>

	* configure.in,src/moviemaker.cc,src/moviemaker.h: Use libswscale to
	  convert images to add to the video.  Movie export now working
	  again!

Fri Jun 17 06:16:46 GMT 2011  Olly Betts <olly@survex.com>

	* src/gfxcore.cc: No need to specify true to PlayPres - that's the
	  default.

Fri Jun 17 06:15:34 GMT 2011  Olly Betts <olly@survex.com>

	* src/gfxcore.cc: Set the play speed to "x1" during video recording.

Fri Jun 17 05:43:12 GMT 2011  Olly Betts <olly@survex.com>

	* src/gfxcore.cc,src/gfxcore.h: Rename 'mpeg' member to 'movie'.

Fri Jun 17 04:30:12 GMT 2011  Olly Betts <olly@survex.com>

	* configure.in,src/moviemaker.cc,src/moviemaker.h: Mostly update movie
	  making code to work with current FFmpeg.  Still TODO: convert call
	  to img_convert() to use sws_scale() - currently you just get an all
	  green movie!

Mon May 30 07:40:12 GMT 2011  Olly Betts <olly@survex.com>

	* buildmacosx.sh: Fix URL for downloading wxWidgets tarball.

Sat May 28 12:39:11 GMT 2011  Olly Betts <olly@survex.com>

	* buildmacosx.sh: Build for x86_64 as well as i386.

Sat May 28 06:14:09 GMT 2011  Olly Betts <olly@survex.com>

	* buildmacosx.sh: Fix comment typo.

Sat May 28 06:08:10 GMT 2011  Olly Betts <olly@survex.com>

	* buildmacosx.sh: Don't assume the volume gets mounted on
	  /Volumes/Survex as it won't be if that mount point is already in use.

Thu May 26 16:09:05 GMT 2011  Olly Betts <olly@survex.com>

	* lib/codes.po,src/aven.cc,src/mainfrm.cc,src/mainfrm.h: Use more stock
	  IDs.

Thu May 26 14:52:00 GMT 2011  Olly Betts <olly@survex.com>

	* lib/,src/printwx.cc: Use stock wx button IDs wxID_PRINT and
	  wxID_PREVIEW where appropriate.

Thu May 26 14:47:52 GMT 2011  Olly Betts <olly@survex.com>

	* lib/codes.po: Mark unused messages by commenting out with '#~'.

Thu May 26 14:34:29 GMT 2011  Olly Betts <olly@survex.com>

	* src/printwx.h: Fix comment typo.

Thu May 26 12:47:44 GMT 2011  Olly Betts <olly@survex.com>

	* src/mainfrm.cc,src/printwx.cc: When using a standard wxID_xxx id with
	  wxButton, use the implicit default label, as the wx documentation
	  recommends.

Thu May 26 12:28:11 GMT 2011  Olly Betts <olly@survex.com>

	* src/: Remove the unused preferences dialog code - we can easily
	  fish it back out of SVN should we want it later, so no point
	  having it sitting there making every checkout bigger.

Tue May 24 05:21:52 GMT 2011  Olly Betts <olly@survex.com>

	* configure.in,doc/Makefile.am,doc/survex.1.in: Move survex man page to
	  section 7 (since it isn't documenting an actual command).

Tue May 24 05:17:53 GMT 2011  Olly Betts <olly@survex.com>

	* doc/Makefile.am: Write generated man page to a temporary file, then
	  atomically rename, to avoid leaving an empty or partial man page
	  behind if docbook-to-man dies (I managed to ship an empty cad3d.1 in
	  1.1.16).

Sat May 21 22:05:04 GMT 2011  Olly Betts <olly@survex.com>

	* lib/fr.po: Fold in addition of accent from launchpad.

Sat May 21 22:04:31 GMT 2011  Olly Betts <olly@survex.com>

	* lib/: Remove comments which are only relevant for other languages
	  from .po files.  Add more clarifying comments.

Thu May 19 05:23:03 GMT 2011  Olly Betts <olly@survex.com>

	* lib/messages.txt: Remove as no longer used.

Wed May 18 09:06:19 GMT 2011  Olly Betts <olly@survex.com>

	* lib/,src/mainfrm.cc,src/mainfrm.h: We now use .po and .pot files as
	  the master format for storing translations in (rather than
	  messages.txt), and then translate these into Survex's .msg format.

Wed May 18 08:37:01 GMT 2011  Olly Betts <olly@survex.com>

	* lib/messages.txt: Fix variant en-us message which ought not be
	  different.

Wed May 18 05:50:07 GMT 2011  Olly Betts <olly@survex.com>

	* make_release: Print out the commands needed to tag the release.

Tue May 17 01:24:59 GMT 2011  Olly Betts <olly@survex.com>

	* lib/messages.txt,src/cavern.c: Drop "non-fatal" from the report of
	  how many errors there were at the end of the run - it just confuses
	  users - we won't even get here if there's a fatal error!
	* lib/messages.txt: Add missing translations of two "Export" variants
	  for ca, sk, and ro.

Tue May 17 01:03:06 GMT 2011  Olly Betts <olly@survex.com>

	* NEWS: Fix typo.

Mon May 16 22:18:53 GMT 2011  Olly Betts <olly@survex.com>

	* buildmacosx.sh: Extract tarball quietly, and just say we're doing
	  it.  Add missing quoting to variable expansions.

Mon May 16 05:59:32 GMT 2011  Olly Betts <olly@survex.com>

	* NEWS: Another pre-1.1.16 update.

Mon May 16 05:54:30 GMT 2011  Olly Betts <olly@survex.com>

	* Makefile.am: Include all the available wxstd.mo files into the
	  Microsoft Windows installer, rather than trying to just include those
	  which we have translations for.  This avoids having to maintain a
	  list of which to include, and gives users translations of wxWidgets
	  messages even if they don't get Survex messages translated.

Mon May 16 05:53:49 GMT 2011  Olly Betts <olly@survex.com>

	* doc/HACKING.htm: Update version of InnoSetup used.  Note the packages
	  needed on Debian to build the Microsoft Windows installer.

Mon May 16 05:22:03 GMT 2011  Olly Betts <olly@survex.com>

	* doc/HACKING.htm: Note Debian packages to install for docs.

Mon May 16 05:21:27 GMT 2011  Olly Betts <olly@survex.com>

	* survex.iss.in: Add comment noting that AppVerName isn't required by
	  newer InnoSetup.

Sun May 15 04:11:34 GMT 2011  Olly Betts <olly@survex.com>

	* NEWS,configure.in: Update for 1.1.16.

Sun May 15 03:44:17 GMT 2011  Olly Betts <olly@survex.com>

	* lib/fixmsgs.pl: Update to fix UTF-8 rather than ISO8859-1.

Sun May 15 03:43:46 GMT 2011  Olly Betts <olly@survex.com>

	* lib/named-entities.txt: Add hellip and rarr.

Sun May 15 03:39:02 GMT 2011  Olly Betts <olly@survex.com>

	* lib/messages.txt: Fix clashing menu shortcuts from recent translation
	  updates.

Sun May 15 03:20:50 GMT 2011  Olly Betts <olly@survex.com>

	* src/message.c: 0x2026 (&hellip;): Handle for WINCP1252, and
	  transliterate to '...' for charsets which don't have it.  0x2192
	  (&rarr;): Transliterate to '->' for charsets which don't have it.
	  Handle &Scaron;, &scaron;, &Zcaron;, &zcaron; for WINCP1252.
	* lib/messages.txt: Use '&rarr;' instead of '->' and '&hellip;' instead
	  of '...'.

Sun May 15 02:59:42 GMT 2011  Olly Betts <olly@survex.com>

	* lib/messages.txt: Fix literal accented characters.

Sun May 15 02:55:50 GMT 2011  Olly Betts <olly@survex.com>

	* lib/messages.txt: Fold in de updates from launchpad.

Sun May 15 02:36:02 GMT 2011  Olly Betts <olly@survex.com>

	* lib/messages.txt: Fold in es updates from launchpad.

Sun May 15 02:19:45 GMT 2011  Olly Betts <olly@survex.com>

	* lib/messages.txt: Fold in it updates from launchpad.

Sun May 15 02:00:45 GMT 2011  Olly Betts <olly@survex.com>

	* lib/messages.txt: Fold in pt-br updates from launchpad.

Sun May 15 01:53:22 GMT 2011  Olly Betts <olly@survex.com>

	* lib/messages.txt: Fold in pt updates from launchpad.

Mon Mar 14 01:58:10 GMT 2011  Olly Betts <olly@survex.com>

	* configure.in: Link with -lGL, if it exists to support linking with
	  gold or GNU ld --as-needed (Debian bug #615781).

Thu Mar 03 13:16:19 GMT 2011  Olly Betts <olly@survex.com>

	* src/img.c: Fix code typo for IMG_API_VERSION == 0 case.

Thu Mar 03 12:32:57 GMT 2011  Olly Betts <olly@survex.com>

	* src/img.c: Fix typo in code used when IMG_HOSTED isn't defined.

Wed Oct 20 09:53:56 GMT 2010  Olly Betts <olly@survex.com>

	* lib/messages.txt: "Colour" -> "Color" in en-us.

Sun Oct 17 14:10:21 GMT 2010  Olly Betts <olly@survex.com>

	* lib/messages.txt: Assorted comment improvements and tweaks.

Sat Oct 16 11:12:42 GMT 2010  Olly Betts <olly@survex.com>

	* src/moviemaker.h: Remove unused <stdio.h>.  Shouldn't include
	  <config.h> in headers, only sources.

Sat Oct 16 10:13:10 GMT 2010  Olly Betts <olly@survex.com>

	* doc/TODO.htm: Remove entries which have now been done.

Fri Oct 15 06:57:46 GMT 2010  Olly Betts <olly@survex.com>

	* tests/extend.tst: Fix to file .espec files when srcdir != builddir.

Fri Oct 15 05:48:09 GMT 2010  Olly Betts <olly@survex.com>

	* NEWS: Final update fro 1.1.15.

Fri Oct 15 05:20:40 GMT 2010  Olly Betts <olly@survex.com>

	* src/editwrap.c: Convert to use wide-character Unicode.

Fri Oct 15 05:20:04 GMT 2010  Olly Betts <olly@survex.com>

	* src/cavernlog.cc: Fix to work on Microsoft Windows.

Thu Oct 14 22:50:09 GMT 2010  Olly Betts <olly@survex.com>

	* tests/extend.tst: Enable eswap-break testcase now that diffpos is
	  fixed.

Thu Oct 14 22:48:06 GMT 2010  Olly Betts <olly@survex.com>

	* src/diffpos.c: Handle files with duplicate labels in better - extend
	  generates duplicate labels when it breaks a loop.

Wed Oct 13 15:39:04 GMT 2010  Olly Betts <olly@survex.com>

	* make_release: -Dunix when running make distcheck with the
	  preprocessor in C89 mode.

Wed Oct 13 15:33:23 GMT 2010  Olly Betts <olly@survex.com>

	* src/cavern.c: Fix C++ comment.

Wed Oct 13 15:07:31 GMT 2010  Olly Betts <olly@survex.com>

	* NEWS,configure.in: 1.1.15.

Wed Oct 13 15:00:51 GMT 2010  Olly Betts <olly@survex.com>

	* configure.in,src/: Define GETC() in config.h and use it everywhere.
	  Similarly define PUTC() to use putc_unlocked() where available and
	  use that everywhere too.

Wed Oct 13 13:41:17 GMT 2010  Olly Betts <olly@survex.com>

	* src/cavernlog.cc: Remove superfluous nested declaration.

Wed Oct 13 11:19:29 GMT 2010  Olly Betts <olly@survex.com>

	* src/cavernlog.cc: mingw doesn't have _get_wpgmptr() so use the
	  deprecated _wpgmptr instead.  mingw doesn't have errno_t so use int
	  instead.

Wed Oct 13 10:49:18 GMT 2010  Olly Betts <olly@survex.com>

	* src/cavernlog.cc: (Microsoft Windows) Quote for any meta characters,
	  not just space.

Wed Oct 13 10:27:38 GMT 2010  Olly Betts <olly@survex.com>

	* src/cavernlog.cc: (Microsoft Windows) Use _get_wpgmptr() to get wide
	  path to aven rather for running cavern.

Thu Oct 07 22:38:43 GMT 2010  Olly Betts <olly@survex.com>

	* src/datain.h,src/useful.c: Use getc_unlocked() if available.

Thu Oct 07 14:25:13 GMT 2010  Olly Betts <olly@survex.com>

	* src/mainfrm.cc: Use _wfopen() on Microsoft Windows when loading and
	  saving presentations so that paths with non-Latin1 characters in can
	  be processed.

Thu Oct 07 12:52:22 GMT 2010  Olly Betts <olly@survex.com>

	* configure.in,src/cavernlog.cc: Use getc_unlocked() if available.

Thu Oct 07 12:42:21 GMT 2010  Olly Betts <olly@survex.com>

	* src/cavernlog.cc: Don't call Update() after every line, but only
	  when we don't have data from cavern pending.  Hopefully addresses
	  ticket#12.

Wed Oct 06 02:25:31 GMT 2010  Olly Betts <olly@survex.com>

	* make_release: Never set CFLAGS or CXXFLAGS in the environment.
	  Build mingw version in an unpacked source tree from the release
	  tarball.

Wed Oct 06 02:09:33 GMT 2010  Olly Betts <olly@survex.com>

	* src/cavernlog.cc: Fix code indentation.

Wed Oct 06 02:08:38 GMT 2010  Olly Betts <olly@survex.com>

	* src/cavernlog.cc: Revert to using mb_str() for popen() and system()
	  on Unix.

Wed Oct 06 02:02:54 GMT 2010  Olly Betts <olly@survex.com>

	* src/cavernlog.cc: Use _wpopen() and _wsystem() on Microsoft Windows
	  so that paths with non-Latin1 characters in can be processed.

Wed Oct 06 01:16:03 GMT 2010  Olly Betts <olly@survex.com>

	* src/cavernlog.cc: Need to quote filenames with spaces in for
	  Microsoft Windows.

Wed Oct 06 00:54:44 GMT 2010  Olly Betts <olly@survex.com>

	* lib/Makefile.am: Ship the extra .isl translation files for Innosetup.

Wed Oct 06 00:49:18 GMT 2010  Olly Betts <olly@survex.com>

	* src/datain.c: Add missing include of date.h.

Wed Oct 06 00:48:28 GMT 2010  Olly Betts <olly@survex.com>

	* src/date.c,src/date.h: Add files for date handling.

Tue Oct 05 12:48:19 GMT 2010  Olly Betts <olly@survex.com>

	* src/gla-gl.cc,src/gla.h: Check whether blobs and crosses actually
	  render correctly as points/point sprites, and if they don't, fall
	  back to drawing them with lines.

Tue Oct 05 10:53:56 GMT 2010  Olly Betts <olly@survex.com>

	* src/gla-gl.cc,src/gla.h: Cache the best method for drawing blobs
	  and crosses, and recheck automatically if the graphics hardware
	  or drivers are changed or upgraded.

Mon Oct 04 11:18:22 GMT 2010  Olly Betts <olly@survex.com>

	* src/gla-gl.cc: Add \n to commented out debug message.

Mon Oct 04 09:58:17 GMT 2010  Olly Betts <olly@survex.com>

	* doc/index.htm.in,doc/manual.sgml,doc/survex.ent,lib/print.ini,
	  src/printwx.cc,survex.iss.in: Use http://survex.com/ rather than
	  http://www.survex.com/ - the former is the canonical name and
	  www.survex.com just redirects.

Mon Oct 04 09:46:24 GMT 2010  Olly Betts <olly@survex.com>

	* src/mainfrm.cc: Don't offer "All files" wildcard in presentation save
	  dialog.

Mon Oct 04 08:19:40 GMT 2010  Olly Betts <olly@survex.com>

	* src/gla-gl.cc: Pass GL_TRUE to OpenGL functions, rather than true.

Sun Oct 03 06:46:03 GMT 2010  Olly Betts <olly@survex.com>

	* src/gfxcore.cc,src/gla-gl.cc,src/gla.h: Use double instead of Double
	  in cases where the value isn't being passed to OpenGL.

Sun Aug 22 13:30:54 GMT 2010  Olly Betts <olly@survex.com>

	* src/gla-gl.cc: If we aren't using GL_POINTS for blobs, draw them
	  using a series of abutting lines rather than with gluDisk which
	  is faster and gives a consistent shape.

Sat Aug 21 14:33:54 GMT 2010  Olly Betts <olly@survex.com>

	* src/gla-gl.cc: Fix another use of GL_POINT_SIZE_RANGE to
	  GL_SMOOTH_POINT_SIZE_RANGE.

Sat Aug 21 14:30:56 GMT 2010  Olly Betts <olly@survex.com>

	* src/gla-gl.cc: Fix non-USE_FNT case to work again (it's limited to
	  ISO-8859-1 characters though).

Sat Aug 21 13:31:17 GMT 2010  Olly Betts <olly@survex.com>

	* src/gla-gl.cc: Use GL_SMOOTH_POINT_SIZE_RANGE and
	  GL_SMOOTH_POINT_SIZE_GRANULARITY instead of GL_POINT_SIZE_RANGE and
	  GL_POINT_SIZE_GRANULARITY (unless they aren't defined) as the latter
	  two are deprecated in OpenGL >= 1.2.  If GL_ALIASED_POINT_SIZE_RANGE
	  is available (OpenGL >= 1.2 again) then report its value in the
	  about box.

Fri Aug 20 12:26:40 GMT 2010  Olly Betts <olly@survex.com>

	* doc/3dformat.htm,lib/messages.txt,src/,tests/: New v7 of .3d format
	  which stores survey dates as number of days since Jan 1st 1900, so
	  we now support dates from 1900-2078 (rather than 1970-2037) with a
	  smaller file size.  The img API is now versioned - you can select
	  the new "version 1" by compiling with -DIMG_API_VERSION=1, which
	  gives the survey dates in days in days1 and days2 instead of as
	  time_t values in date1 and date2.  Fixes ticket#14.

Fri Aug 20 12:12:54 GMT 2010  Olly Betts <olly@survex.com>

	* src/printwx.cc: Remove unused '#include <time.h>'.

Fri Aug 20 12:10:55 GMT 2010  Olly Betts <olly@survex.com>

	* src/avenprcore.cc: Remove unused '#include <time.h>'.

Fri Aug 20 10:10:05 GMT 2010  Olly Betts <olly@survex.com>

	* src/export.cc: Explicit #include <time.h> for strftime().

Wed Aug 18 13:59:30 GMT 2010  Olly Betts <olly@survex.com>

	* src/osdepend.h: Remove workaround for DOS Turbo C compiler.

Wed Aug 18 02:03:39 GMT 2010  Olly Betts <olly@survex.com>

	* buildmacosx.sh,configure.in,lib/Info.plist.in: Make buildmacosx.sh
	  work.

Tue Aug 17 01:43:24 GMT 2010  Olly Betts <olly@survex.com>

	* src/gfxcore.h: "using svx::Point;" gives an error, so use a macro
	  instead.

Wed Aug 04 03:27:22 GMT 2010  Olly Betts <olly@survex.com>

	* src/img.c: Fix cast in get16() to be to short not long.

Wed Aug 04 02:32:16 GMT 2010  Olly Betts <olly@survex.com>

	* src/cavernlog.cc,src/cavernlog.h: "Rerun" -> "Reprocess" to follow
	  terminology in manual, etc.  Fixes ticket#15.

Wed Jul 28 17:06:49 GMT 2010  Olly Betts <olly@survex.com>

	* tests/: Most tests weren't actually running and testcases (looks like
	  a sh portability issue).  Fixed, and fortunately all tests still
	  pass.

Mon Jul 26 12:30:43 GMT 2010  Olly Betts <olly@survex.com>

	* doc/manual.sgml: Fix typo "of" -> "on".

Mon Jul 26 11:59:59 GMT 2010  Olly Betts <olly@survex.com>

	* NEWS,configure.in: Update for 1.1.14.

Mon Jul 26 11:53:01 GMT 2010  Olly Betts <olly@survex.com>

	* lib/messages.txt,src/: Remove things we no longer need now we've
	  dropped support for RISC OS and DOS.

Mon Jul 26 11:19:40 GMT 2010  Olly Betts <olly@survex.com>

	* src/cmdline.c: Remove reference to MSDOS.

Mon Jul 26 10:23:07 GMT 2010  Olly Betts <olly@survex.com>

	* src/: Strip out "Far" and "Huge" which we no longer need now that
	  DOS memory models are no longer relevant.

Mon Jul 26 09:57:37 GMT 2010  Olly Betts <olly@survex.com>

	* configure.in: No need for AC_PROG_MAKE_SET when using automake.

Mon Jul 26 09:48:10 GMT 2010  Olly Betts <olly@survex.com>

	* configure.in,src/useful.h: On little-endian architectures, make
	  get16() and get32() inline functions, rather than macros which use 
	  a global variable.

Mon Jul 26 09:31:14 GMT 2010  Olly Betts <olly@survex.com>

	* src/useful.c: Remove commented out code.

Mon Jul 26 09:19:19 GMT 2010  Olly Betts <olly@survex.com>

	* configure.in,src/img.c,src/useful.c,src/useful.h: Use AC_TYPE_INT16_T
	  and AC_TYPE_INT32_T instead of home-brew equivalents.

Mon Jul 26 08:40:43 GMT 2010  Olly Betts <olly@survex.com>

	* src/listpos.c: In "Station X referred to just once, with an explicit
	  prefix - typo?" warning, give file and linenumber where the *equate
	  occurred.

Mon Jul 26 08:37:46 GMT 2010  Olly Betts <olly@survex.com>

	* src/readval.c: Fix comment typo.

Mon Jul 26 08:29:41 GMT 2010  Olly Betts <olly@survex.com>

	* src/listpos.c: In "Station X referred to by *entrance or *export but
	  never used" warning, give file and linenumber where the *entrance or
	  *export occurred.

Mon Jul 26 07:44:26 GMT 2010  Olly Betts <olly@survex.com>

	* src/aventreectrl.cc: Fix double-click handling for survey tree on
	  wxMSW >= 2.8.11.

Mon Jul 26 07:25:59 GMT 2010  Olly Betts <olly@survex.com>

	* src/mainfrm.cc: Stop passing wxNO_FULL_REPAINT_ON_RESIZE as it is 0
	  on all versions of wxWidgets we support (i.e. 2.6 and later).

Mon Jul 26 07:21:35 GMT 2010  Olly Betts <olly@survex.com>

	* INSTALL,src/: Restore compatibility with wxWidgets 2.6.

Mon Jul 26 06:29:03 GMT 2010  Olly Betts <olly@survex.com>

	* src/netskel.c: In "Unused fixed point" warning, give file and
	  linenumber where the "*fix" occurred.

Mon Jul 26 06:24:35 GMT 2010  Olly Betts <olly@survex.com>

	* src/cavernlog.cc: Fix highlighting of links in CavernLog window to
	  highlight just <file>:<line> (and not the ': ' after), and to make
	  the title for the terminal the warning/error message.  Make the
	  checking stricter by checking that the linenumber is a number, to
	  avoid false positives.

Mon Jul 26 04:48:12 GMT 2010  Olly Betts <olly@survex.com>

	* Revert this change, as it appears wxMotif does support wxGLCanvas:
	* doc/manual.sgml: wxMotif apparently doesn't support wxGLCanvas, which
	  is required by Aven in 1.1.x, so remove mention of Motif from manual.

Mon Jul 26 03:24:38 GMT 2010  Olly Betts <olly@survex.com>

	* src/: Add "Rerun" and "OK" buttons to the CavernLog window (as
	  appropriate).  (Addition of "OK" button fixes ticket#13).  Fix up
	  handling of splitter window to fix poor handling of various cases.

Sun Jul 25 15:32:42 GMT 2010  Olly Betts <olly@survex.com>

	* src/mainfrm.cc,src/mainfrm.h: Clean up code which sorts out loading
	  a file (and processing it first if necessary).

Sun Jul 25 07:20:05 GMT 2010  Olly Betts <olly@survex.com>

	* src/cavernlog.h: Fix filename in comment at top.

Sun Jul 25 07:17:20 GMT 2010  Olly Betts <olly@survex.com>

	* src/cavernlog.cc: Don't double escape the contents of href and target
	  in links in the log.

Sun Jul 25 06:32:24 GMT 2010  Olly Betts <olly@survex.com>

	* src/cavernlog.cc: Remove commented out calls to set the input
	  encoding of the HTML parser - we now always escape non-ASCII
	  characters as HTML entities.

Fri Jul 23 14:15:25 GMT 2010  Olly Betts <olly@survex.com>

	* src/cavernlog.h: Improve doc comment for process() method.

Fri Jul 23 12:38:43 GMT 2010  Olly Betts <olly@survex.com>

	* src/printwx.cc,src/printwx.h: Don't compile in the preview code when
	  we disable the preview feature.

Fri Jul 23 12:15:31 GMT 2010  Olly Betts <olly@survex.com>

	* src/printwx.cc: The Gnome print dialog has its own preview window
	  so suppress ours if using the Gnome one.

Fri Jul 23 11:21:52 GMT 2010  Olly Betts <olly@survex.com>

	* configure.in: Update the wx-config probing code - wxmac-config etc
	  aren't present with newer wxWidgets versions.

Fri Jul 23 05:55:37 GMT 2010  Olly Betts <olly@survex.com>

	* buildmacosx.sh: Update to use WX_CONFIG not WXCONFIG.  Update to
	  use a Unicode build.  If building a private wx, use wx 2.8.11 not
	  2.7.0-1 (and don't replace carbon-glcanvas.cpp with our own version).

Sat Jul 10 12:15:23 GMT 2010  Olly Betts <olly@survex.com>

	* src/cavernlog.cc: Set the select timeout before calling wxYield()
	  when waiting for output from cavern to 0.1s instead of 0.00001s to
	  avoid yielding excessively on slower machines where this is likely
	  to really slow things down.  Call Scroll() only once per line in
	  the case where we are updating the scrollbar position.  Call
	  Update() instead of wxYield() after each line, since that's enough
	  to get the window updated.  Remove unused assignment "ch = left;"
	  at end of loop.

Fri Jul 09 14:42:47 GMT 2010  Olly Betts <olly@survex.com>

	* configure.in: Link aven with -lGLU which SuSE Linux needs.

Fri Jul 09 14:31:39 GMT 2010  Olly Betts <olly@survex.com>

	* src/mainfrm.cc: Highlight stations matching any current search when a
	  file is loaded.  (ticket#9)

Thu Jul 01 12:20:58 GMT 2010  Olly Betts <olly@survex.com>

	* survex.iss.in: Clean up comments from over-enthusiastic search and
	  replace which modified comments as well as code.

Thu Jul 01 10:15:06 GMT 2010  Olly Betts <olly@survex.com>

	* src/gfxcore.h: Work around Mac OS X polluting the global namespace
	  with a "Point" class.

Thu Jul 01 10:10:45 GMT 2010  Olly Betts <olly@survex.com>

	* src/Makefile.am: Remove FIXME which has already been resolved.

Fri Jun 18 11:04:35 GMT 2010  Olly Betts <olly@survex.com>

	* doc/manual.sgml: wxMotif apparently doesn't support wxGLCanvas, which
	  is required by Aven in 1.1.x, so remove mention of Motif from manual.

Fri Jun 18 03:03:55 GMT 2010  Olly Betts <olly@survex.com>

	* doc/manual.sgml,src/aventreectrl.cc,src/gfxcore.cc,src/mainfrm.h:
	  Correctly capitalise "GTK".

Fri Jun 18 02:58:06 GMT 2010  Olly Betts <olly@survex.com>

	* doc/manual.sgml: Note that on Linux we only regularly test builds
	  with the GTK+ version (change taken from 1.0).

Wed Jun 16 04:44:26 GMT 2010  Olly Betts <olly@survex.com>

	* doc/Makefile.am: Use stampfile to stop unwanted rebuilds of the HTML
	  version of the manual.

Wed Jun 16 02:59:48 GMT 2010  Olly Betts <olly@survex.com>

	* configure.in: Only ask for core, gl, and html wx libs to avoid
	  linking to a load of others we don't use.

Tue Jun 15 17:01:41 GMT 2010  Olly Betts <olly@survex.com>

	* INSTALL: Update.

Tue Jun 15 16:53:28 GMT 2010  Olly Betts <olly@survex.com>

	* src/aven.cc: Fix to work with wxWidgets 2.6 too.

Tue Jun 15 15:38:49 GMT 2010  Olly Betts <olly@survex.com>

	* lib/survex-aven.desktop,lib/survex-svxedit.desktop: Merge in .desktop
	  file updates from 1.0.39.1-4 Debian package.

Tue Jun 15 14:40:04 GMT 2010  Olly Betts <olly@survex.com>

	* doc/Makefile.am: Fix lingering references to @DOCS_OTHER@.

Tue Jun 15 14:32:55 GMT 2010  Olly Betts <olly@survex.com>

	* NEWS: Update from ChangeLog.

Tue Jun 15 14:09:29 GMT 2010  Olly Betts <olly@survex.com>

	* Makefile.am,configure.in,doc/Makefile.am,make_release: Scrap the
	  "alternative manual formats" zip file - people will generally just
	  want one of them, so downloading several together isn't very useful.
	  Replace PostScript version of manual with a PDF version (more
	  compact and more people will have software to read PDF).  Don't
	  generate RTF format by default as PDF is more useful if you want
	  a formatted version to print.

Tue Jun 15 13:36:30 GMT 2010  Olly Betts <olly@survex.com>

	* doc/manual.sgml: Merge the "Contributing" section into the "Mailing
	  List" section.

Tue Jun 15 12:57:13 GMT 2010  Olly Betts <olly@survex.com>

	* Makefile.am,make_release: Just produce a zip file with the
	  alternative manual formats - a self-extracting .exe is harder to
	  use on other platforms, and most people have a zip file extractor
	  installed.

Tue Jun 15 12:36:13 GMT 2010  Olly Betts <olly@survex.com>

	* survex.spec.in: Update survex.com URLs to drop "www.".  Update
	  wxGTK dependency to >= 2.6.0.  Reenable "BuildRequires:" as
	  the issue with building the package on Debian is no longer
	  relevant.

Tue Jun 15 12:35:19 GMT 2010  Olly Betts <olly@survex.com>

	* doc/manual.sgml: Update (C) years.  "MacOS X" -> "Mac OS X".

Tue Jun 15 12:13:42 GMT 2010  Olly Betts <olly@survex.com>

	* doc/manual.sgml: Remove out of date postal addresses - we can
	  probably safely assume people have email these days.  Direct
	  people to the mailing list since they are likely to get a
	  quicker response rather than mailing individuals.  Remove
	  mention of a paper mailing list.  Remove mention of sending
	  us a floppy (!) or blank CDR to get a version as I can't recall
	  the last time I gave someone a copy on physical media.

Tue Jun 15 11:22:56 GMT 2010  Olly Betts <olly@survex.com>

	* Makefile.am,make_release: I can't persuade rpmbuild to work sanely,
	  and people can just as easily build binary RPMs from the source
	  tarball as from the srpm, so just remove the rpm target from the
	  makefile and code which uses it from make_release - it's less to
	  have to maintain too.

Tue Jun 15 10:59:12 GMT 2010  Olly Betts <olly@survex.com>

	* make_release: Use "set -e" rather than checking the exit codes of
	  commands.  -t no longer disables targets - set mk to do that.

Tue Jun 15 09:41:11 GMT 2010  Olly Betts <olly@survex.com>

	* make_release: Fix defaulting of list of things to do.

Tue Jun 15 09:12:00 GMT 2010  Olly Betts <olly@survex.com>

	* src/gdtconvert: Add "Generated" comment to output file.

Tue Jun 15 09:10:02 GMT 2010  Olly Betts <olly@survex.com>

	* src/gdtconvert: Add GPL license boilerplate.

Tue Jun 15 08:53:28 GMT 2010  Olly Betts <olly@survex.com>

	* src/gettexttomsg.pl,src/wx.h: Add GPL boilerplate to files which were
	  missing it.

Tue Jun 15 08:46:28 GMT 2010  Olly Betts <olly@survex.com>

	* src/: Update FSF address in licence notices.

Tue Jun 15 08:06:09 GMT 2010  Olly Betts <olly@survex.com>

	* src/guicontrol.cc: Allow "Toggle Fullscreen" to work even if no
	  survey is loaded now that we persist the window size between
	  invocations.

Tue Jun 15 08:03:53 GMT 2010  Olly Betts <olly@survex.com>

	* src/gla-gl.cc: Use GL_BLEND rather than GL_ALPHA to work better with
	  anti-aliased TXF files.

Tue Jun 15 07:59:09 GMT 2010  Olly Betts <olly@survex.com>

	* src/fnt.cc: Use font size from txf file rather than trying to
	  calculate it from the texture fragment sizes.

Tue Jun 15 07:48:13 GMT 2010  Olly Betts <olly@survex.com>

	* lib/Makefile.am,lib/TexFont.h,lib/gentexfont.c: Generate aven.txf with
	  afm2txf.pl instead of gentexfont because gentexfont's licence doesn't
	  allow distribution of modified versions.

Tue Jun 15 07:43:48 GMT 2010  Olly Betts <olly@survex.com>

	* lib/afm2txf.pl: Add support for -o option to specify output .txf
	  file.

Tue Jun 15 07:10:16 GMT 2010  Olly Betts <olly@survex.com>

	* lib/afm2txf.pl: Sanitise $FONT to ensure it doesn't contain a '/'.
	  Remove the temporary .ppm file at the end.

Tue Jun 15 06:13:30 GMT 2010  Olly Betts <olly@survex.com>

	* lib/afm2txf.pl: Fix alignment of characters, backported from PLIB
	  SVN.

Tue Jun 15 05:05:05 GMT 2010  Olly Betts <olly@survex.com>

	* lib/afm2txf.pl: Quote $FONT when passing to external commands.

Tue Jun 15 04:24:33 GMT 2010  Olly Betts <olly@survex.com>

	* lib/afm2txf.pl: Change character 96 from "grave" to "quoteleft".

Tue Jun 15 04:22:59 GMT 2010  Olly Betts <olly@survex.com>

	* lib/afm2txf.pl: Extend to cover ISO-8859-1, not just ASCII.

Tue Jun 15 04:08:34 GMT 2010  Olly Betts <olly@survex.com>

	* lib/afm2txf.pl: Clean up trailing whitespace.

Tue Jun 15 04:02:40 GMT 2010  Olly Betts <olly@survex.com>

	* lib/afm2txf.pl: Add GPL script for creating txf files.

Mon Jun 14 06:33:11 GMT 2010  Olly Betts <olly@survex.com>

	* lib/splash.png: Remove now unused graphical splash screen (it has
	  hardcoded (C) details, which wasn't a good approach).

Mon Jun 14 05:20:44 GMT 2010  Olly Betts <olly@survex.com>

	* src/fnt.cc: Handle the left bearing and character width correctly.

Mon Jun 14 04:44:22 GMT 2010  Olly Betts <olly@survex.com>

	* src/fnt.cc: Change back to not using GL_COLOR_INDEX, but with still
	  being able to set the font texture from a byte array.

Mon Jun 14 04:23:22 GMT 2010  Olly Betts <olly@survex.com>

	* src/fnt.h,src/gla-gl.cc: Pass the length of the string to
	  fntTexFont::puts() rather than recalculating it inside the
	  method.

Sun Jun 13 12:57:08 GMT 2010  Olly Betts <olly@survex.com>

	* src/mainfrm.cc: Fix switching to and from the CavernLogWindow pane
	  to use wxSplitterWindow::ReplaceWindow() which fixes various issues
	  with sizing and resizing of the panes.

Sun Jun 13 12:23:23 GMT 2010  Olly Betts <olly@survex.com>

	* src/: Add wmsg_cfgpth() which caches the result of msg_cfgpth() as
	  a wxString.

Sun Jun 13 06:57:07 GMT 2010  Olly Betts <olly@survex.com>

	* src/cavernlog.cc,src/gla-gl.cc,src/mainfrm.cc: wxString::fn_str() on
	  wxmsw returns a wide string, which doesn't work with fopen(), etc, so
	  call char_str() instead for now.

Sun Jun 13 05:41:30 GMT 2010  Olly Betts <olly@survex.com>

	* src/printwx.cc: Use wxString::FromAscii() for the units on the scale
	  bar which we know to be ASCII.  No need to use msgPerm() for a
	  message we assign to a wxString.

Sun Jun 13 04:44:30 GMT 2010  Olly Betts <olly@survex.com>

	* src/mainfrm.cc,src/printwx.cc: Use wxFileName::SplitPath() instead of
	  baseleaf_from_fnm().

Sun Jun 13 00:57:11 GMT 2010  Olly Betts <olly@survex.com>

	* src/export.cc,src/gfxcore.cc: wxString::fn_str() on wxmsw returns
	  a wide string, which doesn't work with fopen(), etc, so call
	  char_str() instead for now.

Sat Jun 12 15:07:54 GMT 2010  Olly Betts <olly@survex.com>

	* src/aven.cc: We can rely on our message catalog being UTF-8 so use
	  wxString::FromUTF8() instead of wxConvUTF8.

Sat Jun 12 14:26:32 GMT 2010  Olly Betts <olly@survex.com>

	* src/gfxcore.cc: Use wxString::FromAscii() to convert date to
	  wxString.

Sun Jun 06 09:36:06 GMT 2010  Olly Betts <olly@survex.com>

	* src/Makefile.am: Use wx-config's --rescomp option to get the command
	  and options needed to turn .rc files into object files.

Fri Jun 04 15:32:27 GMT 2010  Olly Betts <olly@survex.com>

	* survex.iss.in: Specify "LZMANumFastBytes=273" which shaves a small
	  amount of the installer size.  Specify "DisableWelcomePage=yes"
	  which is apparently in line with what other modern installers do.

Fri Jun 04 14:32:04 GMT 2010  Olly Betts <olly@survex.com>

	* configure.in,make_release,make_release.in: We no longer need VERSION
	  in make_release, so no need to generate it from configure.

Fri Jun 04 14:00:58 GMT 2010  Olly Betts <olly@survex.com>

	* Makefile.am,xvfb-run: We no longer need an X display to run ISCC
	  under Wine, so just run wine directly and removed version of
	  Debian's xvfb-run script.
	* make_release.in: Pass variables to configure on the command line
	  rather than in the enviornment.  Running "make distcheck" no longer
	  fails extend.tst, so remove comment about that.  Use case rather
	  than expr to check what we've been asked to build.  Update to use
	  unicode wx-config script for wxmsw.  The wxmsw build spews warnings
	  about aliasing issues, so turn on -fno-strict-aliasing to avoid any
	  potential bugs from that.  Enable -Werror for the wxmsw build.
	* Makefile.am: Update list of wxstd.mo files we package for wxmsw
	  (add pt and sk) and where we copy them from.  Copy the unofficial
	  InnoSetup i18n files (.isl) from lib.

Fri Jun 04 13:40:35 GMT 2010  Olly Betts <olly@survex.com>

	* doc/HACKING.htm: Update InnoSetup info.

Fri Jun 04 13:07:01 GMT 2010  Olly Betts <olly@survex.com>

	* survex.iss.in: Update for InnoSetup 5.3.9.
	* lib/English_GB.isl,lib/Romanian-7-5.1.11.isl: Check in the unofficial
	  i18n files for InnoSetup which we use.

Fri Jun 04 13:05:18 GMT 2010  Olly Betts <olly@survex.com>

	* src/Makefile.am: Update path to wx RC file.

Fri Jun 04 12:44:39 GMT 2010  Olly Betts <olly@survex.com>

	* src/mainfrm.cc: Explicitly construct temporary wxString() which
	  is needed to avoid overload ambiguity under __WXMSW__.

Fri Jun 04 12:41:59 GMT 2010  Olly Betts <olly@survex.com>

	* src/cavernlog.cc: Add missing wxT() to string and character
	  constants only used in __WXMSW__ build.

Fri Jun 04 12:19:18 GMT 2010  Olly Betts <olly@survex.com>

	* src/aven.cc: wxWidgets now has a Slovak translation, so remove the
	  kludge to substitute Czech if Slovak isn't found.

Fri Jun 04 05:08:14 GMT 2010  Olly Betts <olly@survex.com>

	* src/aboutdlg.cc: Fix character constant to be a string constant when
	  building under WXMSW.

Thu Jun 03 13:53:57 GMT 2010  Olly Betts <olly@survex.com>

	* NEWS: Update from ChangeLog for 1.1.13.

Thu Jun 03 12:25:14 GMT 2010  Olly Betts <olly@survex.com>

	* Makefile.am,configure.in,debian/Makefile.am,debian/changelog: Remove
	  .deb building machinery from upstream Makefile.

Thu Jun 03 12:14:16 GMT 2010  Olly Betts <olly@survex.com>

	* make_release.in: Remove ancient workaround for getting wine to work.
	  Remove .deb building machinery.  Reenable distcheck to see if the
	  problem with extend.tst has gone away.  Update mingw cross-building
	  machinery.

Wed Jun 02 13:30:28 GMT 2010  Olly Betts <olly@survex.com>

	* configure.in,doc/GPL.htm,doc/index.htm.in: Remove HTML version of GPL
	  - just link to the FSF's page.

Wed Jun 02 13:26:55 GMT 2010  Olly Betts <olly@survex.com>

	* configure.in,make_release,make_release.in,update-debcl.pl: Use dch to
	  update debian/changelog.

Wed Jun 02 12:59:33 GMT 2010  Olly Betts <olly@survex.com>

	* configure.in,doc/Makefile.am,doc/cl2html.pl,doc/index.htm.in: Stop
	  generating an HTML version of the ChangeLog - it's too low level to
	  be of interest to non-developers, and developers can look at the
	  source code.

Wed Jun 02 09:38:25 GMT 2010  Olly Betts <olly@survex.com>

	* src/cavernlog.cc: Whitespace tweaks.

Wed Jun 02 09:28:37 GMT 2010  Olly Betts <olly@survex.com>

	* src/aboutdlg.cc,src/aboutdlg.h: Use standard button for "Copy" in
	  About dialog.  Change "OK" button to "Close" since nothing is being
	  confirmed by clicking it.  Call "Flush()" in wxTheClipboard to try
	  to make the copied text persist after aven is closed, though this
	  seems to currently do nothing on wxGTK at least.

Tue May 18 12:59:00 GMT 2010  Olly Betts <olly@survex.com>

	* doc/HACKING.htm: Note jadetex needed.
	  Note autoconf 2.64 works well.

Tue May 18 02:06:00 GMT 2010  Olly Betts <olly@survex.com>

	* src/fnt.cc: Remove now superfluous ().

Mon May 17 14:33:00 GMT 2010  Olly Betts <olly@survex.com>

	* debian/Makefile.am: Update EXTRA_DIST

Mon May 17 05:38:00 GMT 2010  Olly Betts <olly@survex.com>

	* src/cavernlog.cc: Fix small memory leak

Mon May 17 05:33:00 GMT 2010  Olly Betts <olly@survex.com>

	* src/img.c: Don't leak filename_opened member.

Mon May 17 05:13:00 GMT 2010  Olly Betts <olly@survex.com>

	* src/gfxcore.cc: Initialise all GfxCore's member variables so we
	  don't use them uninitialised.

Mon May 17 05:11:00 GMT 2010  Olly Betts <olly@survex.com>

	* src/gfxcore.h: Declare constants with enum rather than #define so
	  they automatically get allocated unique values, and so they show up
	  in the debugger.

Mon May 17 02:39:00 GMT 2010  Olly Betts <olly@survex.com>

	* src/fnt.cc: Make the map array static const

Mon May 17 02:30:00 GMT 2010  Olly Betts <olly@survex.com>

	* src/fnt.cc: Set the font texture with GL_COLOR_INDEX so we can
	  use a "byte format" font file without any translation, while a
	  "bitmap format" font file needs a temporary array half the size.

Mon May 17 00:56:00 GMT 2010  Olly Betts <olly@survex.com>

	* src/gfxcore.cc: Initialise 3 flags when we load a survey to avoid
	  using them potentially uninitialised.

Sun May 16 14:39:00 GMT 2010  Olly Betts <olly@survex.com>

	* src/mainfrm.cc: Fix cavern log window to behave if passed a .svx
	  file on the command line.

Sun May 16 14:27:00 GMT 2010  Olly Betts <olly@survex.com>

	* configure.in: Update copyright years.

Sun May 16 14:23:00 GMT 2010  Olly Betts <olly@survex.com>

	* configure.in, src/aboutdlg.cc, src/aboutdlg.h, src/aven.cc,
	  src/aven.h, src/avenprcore.cc, src/avenprcore.h,
	  src/cavernlog.cc, src/cavernlog.h, src/export.cc, src/fnt.h,
	  src/gfxcore.cc, src/gla-gl.cc, src/gla.h, src/guicontrol.cc,
	  src/log.cc, src/mainfrm.cc, src/mainfrm.h, src/namecmp.h,
	  src/printwx.cc, src/printwx.h:
	  + Fix to build with a "unicode" build of wx.
	  + Add "Copy" button to the About dialog to copy the system info
	    to the clipboard.
	  + List OpenGL extensions last, since there are usually lots of
	    them with a modern gfx card.
	  + When processing survey data, auto-scroll the log window until
	    we've reported a warning or error.
	  + Put the survey data log window in a splitter in the standard
	    frame rather than having a separate frame for it.

Sat Apr 17 12:13:00 GMT 2010  Olly Betts <olly@survex.com>

	* src/aboutdlg.cc: Add case for "GTK+ >= 2.6".

Sat Apr 17 12:12:00 GMT 2010  Olly Betts <olly@survex.com>

	* src/aboutdlg.cc: Build string using preprocessor string
	  concatenation rather than runtime appending, where possible.

Sat Apr 17 12:00:00 GMT 2010  Olly Betts <olly@survex.com>

	* src/aboutdlg.cc: Update (C) date.

Sat Apr 17 11:59:00 GMT 2010  Olly Betts <olly@survex.com>

	* src/aboutdlg.cc, src/aboutdlg.h: Use a wxTimer instead of idle
	  events to avoid spinning on the CPU.

Sat Apr 17 11:41:00 GMT 2010  Olly Betts <olly@survex.com>

	* configure.in: New preferred env var for wx-config script is
	  WX_CONFIG.  WXCONFIG still supported for compatibility.

Tue Jul 28 08:16:00 GMT 2009  Olly Betts <olly@survex.com>

	* src/mainfrm.cc: The presentation filename now defaults to using
	  the basename of the currently loaded dataset, but we always prompt
	  before we first save with such a name.

Tue Jul 28 04:37:00 GMT 2009  Olly Betts <olly@survex.com>

	* configure.in: Add comment to explain why we call wx-config twice.

Tue Jul 28 04:36:00 GMT 2009  Olly Betts <olly@survex.com>

	* src/datain.c: Use fputs(m, f) instead of fprintf(f, m) in case m
	  contains '%' (m comes from the messages file, so this isn't
	  exploitable by sending someone a "bad" .svx or .3d file).

Mon Jul 27 03:29:00 GMT 2009  Olly Betts <olly@survex.com>

	* src/mainfrm.cc: Fix to open rather than save when doing "open
	  presentation" with wxmotif.

Thu Mar 05 01:45:00 GMT 2009  Olly Betts <olly@survex.com>

	* doc/3dformat.htm: Document that this is version 6 and when we
	  started to use it.

Mon Dec 15 10:34:00 GMT 2008  Olly Betts <olly@survex.com>

	* src/gla-gl.cc: When saving a screenshot, perform the vertical
	  flip of the image data in-place rather than using wxImage::Mirror()
	  which creates a whole new wxImage object.

Fri Dec 12 11:12:00 GMT 2008  Olly Betts <olly@survex.com>

	* src/cad3d.c, src/export.cc: Fix export to SVG when a label
	  contains a '%' character.

Fri Dec 12 06:30:00 GMT 2008  Olly Betts <olly@survex.com>

	* configure.in: Add AM_PROG_CC_C_O which newer autoreconf warns is
	  needed.

Fri Dec 12 06:28:00 GMT 2008  Olly Betts <olly@survex.com>

	* configure.in: Remove AC_SUBST of CRLIB and CROBJX which are no
	  longer set or used.

Fri Dec 12 06:03:00 GMT 2008  Olly Betts <olly@survex.com>

	* NEWS, buildmacosx.sh, configure.in, desc-aven.txt, doc/TODO.htm,
	  doc/manual.sgml, doc/survex.ent, lib/messages.txt,
	  src/aboutdlg.cc, src/aven.cc, src/aven.h, src/gfxcore.cc,
	  src/mainfrm.cc, src/printwx.cc, src/printwx.h, src/wx.h: Say
	  "wxWidgets" instead of "wxWindows" consistently.
	  Require wxWidgets 2.6.0 or newer - 2.4 is really old now.

Mon Mar 31 01:53:00 GMT 2008  Olly Betts <olly@survex.com>

	* doc/3dformat.htm: Update for v6 format from Mike McCombe

Fri Sep 07 18:29:00 GMT 2007  Olly Betts <olly@survex.com>

	* src/gla-gl.cc: Calling glGetError() resets the error state, so we
	  need to store the value in a variable rather than calling it twice!

Fri Sep 07 13:54:00 GMT 2007  Olly Betts <olly@survex.com>

	* src/gla-gl.cc: Add missing CHECK_GL_ERROR() calls and correct
	  some which had the wrong descriptions.
	  Use GL_POINT_SPRITE and GL_COORD_REPLACE instead of
	  GL_POINT_SPRITE_ARB and GL_COORD_REPLACE_ARB.  They have the same
	  numeric values, so the shorter (now official) names are better.

Fri Sep 07 13:31:00 GMT 2007  Olly Betts <olly@survex.com>

	* src/Makefile.am, src/gfxcore.cc, src/gfxcore.h, src/gla-gl.cc,
	  src/gla.h, src/matrix4.cc, src/matrix4.h, src/quaternion.cc,
	  src/quaternion.h: Just set the pan and tilt directly as OpenGL
	  rotations rather than messing around setting up and then decoding a
	  quaternion.  This fixes some glitches when tilting while looking
	  east, and eliminates 2 source files and 2 headers!

Sat Feb 10 13:56:00 GMT 2007  Olly Betts <olly@survex.com>

	* NEWS, configure.in, src/aven.cc, src/wx.h:
	  (Unix version): aven: Fix display of degree symbol in status bar and
	  messages with accented characters in.
	  (Mac OS X version): Require at least wxWidgets 2.5.1.

Sat Feb 10 13:46:00 GMT 2007  Olly Betts <olly@survex.com>

	* src/message.c: Test S_ISREG since that's what we use here

Sat Feb 10 13:37:00 GMT 2007  Olly Betts <olly@survex.com>

	* src/message.c: Always use utf-8 for aven on unix

