[Setup]
AppName=@PRETTYPACKAGE@
AppVerName=@PRETTYPACKAGE@ @VERSION@
DefaultDirName={pf}\@PRETTYPACKAGE@
DefaultGroupName=@PRETTYPACKAGE@
OutputBaseFilename=@PACKAGE@-win32-@VERSION@
AlwaysCreateUninstallIcon=yes
AppPublisher=The Survex Project
AppPublisherURL=http://www.survex.com/
AppVersion=@VERSION@
ChangesAssociations=yes
LicenseFile=COPYING.txt
Uninstallable=yes
AppCopyright=@COPYRIGHT_MSG@
; WizardImageFile=survey.bmp
[Dirs]
Name: "{app}\help"

[Files]
Source: "*.exe"; DestDir: "{app}"
Source: "*.msg"; DestDir: "{app}"
Source: "*.txt"; DestDir: "{app}"
Source: "*.bit"; DestDir: "{app}"
Source: "*.ini"; DestDir: "{app}"
Source: "*.svx"; DestDir: "{app}"
Source: "*.ico"; DestDir: "{app}"
Source: "*.htm"; DestDir: "{app}"
Source: "*.png"; DestDir: "{app}"
Source: "help\*.*"; DestDir: "{app}\help"

[Icons]
Name: "{group}\Aven"; Filename: "{app}\aven.exe"; Comment: "View processed surveys"
Name: "{group}\Documentation"; Filename: "{app}\docindex.htm"; Comment: "View the documentation for Survex"

[Registry]
Root: HKCR; Subkey: ".svx"; ValueType: string; ValueData: "survex.source"; Flags: uninsdeletevalue
Root: HKCR; Subkey: ".3d"; ValueType: string; ValueData: "survex.bin"; Flags: uninsdeletevalue
Root: HKCR; Subkey: ".err"; ValueType: string; ValueData: "survex.error"; Flags: uninsdeletevalue
Root: HKCR; Subkey: ".pos"; ValueType: string; ValueData: "survex.pos"; Flags: uninsdeletevalue
Root: HKCR; Subkey: ".log"; ValueType: string; ValueData: "survex.log"; Flags: uninsdeletevalue
Root: HKCR; Subkey: "survex.source"; ValueType: string; ValueData: "Survex Raw Survey Data"; Flags: uninsdeletevalue
Root: HKCR; Subkey: "survex.source\DefaultIcon"; ValueType: string; ValueData: "{app}\survex.ico"; Flags: uninsdeletevalue
Root: HKCR; Subkey: "survex.source\shell"; ValueType: string; ValueData: "Process"; Flags: uninsdeletevalue
Root: HKCR; Subkey: "survex.source\shell\Process\command"; ValueType: string; ValueData: """{app}\cavern.exe"" --log -o ""%1"" ""%1"""; Flags: uninsdeletevalue
Root: HKCR; Subkey: "survex.source\shell"; ValueType: string; ValueData: "Open"; Flags: uninsdeletevalue
Root: HKCR; Subkey: "survex.source\shell\open\command"; ValueType: string; ValueData: """notepad.exe"" ""%1"""; Flags: uninsdeletevalue
Root: HKCR; Subkey: "survex.bin"; ValueType: string; ValueData: "Survex Processed Data"; Flags: uninsdeletevalue
Root: HKCR; Subkey: "survex.bin\DefaultIcon"; ValueType: string; ValueData:"{app}\3d.ico"; Flags: uninsdeletevalue
Root: HKCR; Subkey: "survex.bin\shell"; ValueType: string; ValueData: "Open"; Flags: uninsdeletevalue
Root: HKCR; Subkey: "survex.bin\shell\open\command"; ValueType: string; ValueData: """{app}\aven.exe"" ""%1"""; Flags: uninsdeletevalue
Root: HKCR; Subkey: "survex.bin\shell"; ValueType: string; ValueData: "Print"; Flags: uninsdeletevalue
Root: HKCR; Subkey: "survex.bin\shell\Print\command"; ValueType: string; ValueData: """{app}\printwin.exe"" ""%1"""; Flags: uninsdeletevalue
Root: HKCR; Subkey: "survex.bin\shell"; ValueType: string; ValueData: "Extend"; Flags: uninsdeletevalue
Root: HKCR; Subkey: "survex.bin\shell\Extend\command"; ValueType: string; ValueData: """{app}\extend.exe"" ""%1"""; Flags: uninsdeletevalue
Root: HKCR; Subkey: "survex.bin\shell"; ValueType: string; ValueData: "Convert to DXF"; Flags: uninsdeletevalue
Root: HKCR; Subkey: "survex.bin\shell\Convert to DXF\command"; ValueType: string; ValueData: """{app}\cad3d.exe"" --dxf ""%1"""; Flags: uninsdeletevalue
Root: HKCR; Subkey: "survex.bin\shell"; ValueType: string; ValueData: "Convert for hand plotting"; Flags: uninsdeletevalue
Root: HKCR; Subkey: "survex.bin\shell\Convert for hand plotting\command"; ValueType: string; ValueData: """{app}\3dtopos.exe"" ""%1"""; Flags: uninsdeletevalue
Root: HKCR; Subkey: "survex.error"; ValueType: string; ValueData: "Survex Loop Closure Errors"; Flags: uninsdeletevalue
; Root: HKCR; Subkey: "survex.error\DefaultIcon"; ValueType: string; ValueData: "{app}\survex.ico"; Flags: uninsdeletevalue
Root: HKCR; Subkey: "survex.error\shell"; ValueType: string; ValueData: "Open"; Flags: uninsdeletevalue
Root: HKCR; Subkey: "survex.error\shell\open\command"; ValueType: string; ValueData: """notepad.exe"" ""%1"""; Flags: uninsdeletevalue
Root: HKCR; Subkey: "survex.error\shell"; ValueType: string; ValueData: "Sort by Error"; Flags: uninsdeletevalue
Root: HKCR; Subkey: "survex.error\shell\Sort by Error\command"; ValueType: string; ValueData: """{app}\sorterr.exe"" -r ""%1"""; Flags: uninsdeletevalue
Root: HKCR; Subkey: "survex.error\shell"; ValueType: string; ValueData: "Sort by Horizontal Error"; Flags: uninsdeletevalue
Root: HKCR; Subkey: "survex.error\shell\Sort by Horizontal Error\command"; ValueType: string; ValueData: """{app}\sorterr.exe"" -r -h ""%1"""; Flags: uninsdeletevalue
Root: HKCR; Subkey: "survex.error\shell"; ValueType: string; ValueData: "Sort by Vertical Error"; Flags: uninsdeletevalue
Root: HKCR; Subkey: "survex.error\shell\Sort by Vertical Error\command"; ValueType: string; ValueData: """{app}\sorterr.exe"" -r -v ""%1"""; Flags: uninsdeletevalue
Root: HKCR; Subkey: "survex.error\shell"; ValueType: string; ValueData: "Sort by Percentage Error"; Flags: uninsdeletevalue
Root: HKCR; Subkey: "survex.error\shell\Sort by Percentage Error\command"; ValueType: string; ValueData: """{app}\sorterr.exe"" -r -p ""%1"""; Flags: uninsdeletevalue
Root: HKCR; Subkey: "survex.error\shell"; ValueType: string; ValueData: "Sort by Error per Leg"; Flags: uninsdeletevalue
Root: HKCR; Subkey: "survex.error\shell\Sort by Error per Leg\command"; ValueType: string; ValueData: """{app}\sorterr.exe"" -r -l ""%1"""; Flags: uninsdeletevalue
Root: HKCR; Subkey: "survex.pos"; ValueType: string; ValueData: "Survex Station Positions"; Flags: uninsdeletevalue
; Root: HKCR; Subkey: "survex.pos\DefaultIcon"; ValueType: string; ValueData: "{app}\survex.ico"; Flags: uninsdeletevalue
Root: HKCR; Subkey: "survex.pos\shell"; ValueType: string; ValueData: "Open"; Flags: uninsdeletevalue
Root: HKCR; Subkey: "survex.pos\shell\open\command"; ValueType: string; ValueData: """notepad.exe"" ""%1"""; Flags: uninsdeletevalue
Root: HKCR; Subkey: "survex.log"; ValueType: string; ValueData: "Output Log"; Flags: uninsdeletevalue
; Root: HKCR; Subkey: "survex.info\DefaultIcon"; ValueType: string; ValueData: "{app}\survex.ico"; Flags: uninsdeletevalue
Root: HKCR; Subkey: "survex.log\shell"; ValueType: string; ValueData: "Open"; Flags: uninsdeletevalue
Root: HKCR; Subkey: "survex.log\shell\open\command"; ValueType: string; ValueData: """notepad.exe"" ""%1"""; Flags: uninsdeletevalue
